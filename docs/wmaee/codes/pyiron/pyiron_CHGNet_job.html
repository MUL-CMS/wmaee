<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>wmaee.codes.pyiron.pyiron_CHGNet_job API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../../../index.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;
                Module Index
            </a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#CHGNet">CHGNet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CHGNet.__init__">CHGNet</a>
                        </li>
                        <li>
                                <a class="variable" href="#CHGNet.structure">structure</a>
                        </li>
                        <li>
                                <a class="variable" href="#CHGNet.input">input</a>
                        </li>
                        <li>
                                <a class="variable" href="#CHGNet.fmax">fmax</a>
                        </li>
                        <li>
                                <a class="variable" href="#CHGNet.max_iter">max_iter</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.calc_static">calc_static</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.calc_minimize">calc_minimize</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.calc_md">calc_md</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.write_input">write_input</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.collect_output">collect_output</a>
                        </li>
                        <li>
                                <a class="function" href="#CHGNet.get_structure">get_structure</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CalcParams">CalcParams</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CalcParams.__init__">CalcParams</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
wmaee<wbr>.codes<wbr>.pyiron<wbr>.pyiron_CHGNet_job    </h1>

                
                        <input id="mod-pyiron_CHGNet_job-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-pyiron_CHGNet_job-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># Metadata</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;David Holec, Amin Sakic&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;David Holec&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;david.holec@unileoben.ac.at&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;2024-12-19&quot;</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.11&quot;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">pyiron_atomistics.atomistics.job.atomistic</span> <span class="kn">import</span> <span class="n">AtomisticGenericJob</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">pyiron_atomistics</span> <span class="kn">import</span> <span class="n">pyiron_to_ase</span><span class="p">,</span> <span class="n">ase_to_pyiron</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">pyiron_base</span> <span class="kn">import</span> <span class="n">GenericParameters</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">write</span><span class="p">,</span> <span class="n">read</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">ase</span> <span class="kn">import</span> <span class="n">Atoms</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">ase.io.trajectory</span> <span class="kn">import</span> <span class="n">Trajectory</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span> <span class="nn">pickle</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="k">class</span> <span class="nc">CHGNet</span><span class="p">(</span><span class="n">AtomisticGenericJob</span><span class="p">):</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    Custom job class for using CHGNet within the pyiron framework.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    This class provides methods to perform static calculations, structure relaxation,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    and molecular dynamics simulations using CHGNet.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Attributes</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    ----------</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    structure : pyiron.atomistics.structure.atoms.Atoms</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        Structure associated with the job.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    input : CalcParams</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        Input parameters for the CHGNet calculations.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        Initialize the CHGNet job.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        Parameters</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        ----------</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        project : pyiron.Project</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">            The pyiron project in which the job resides.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        job_name : str</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">            Name of the job.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CHGNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">CalcParams</span><span class="p">()</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">file_exists</span><span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">from_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_executable_activate</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s1">&#39;chgnet&#39;</span><span class="p">)</span>            
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="nd">@property</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        Get the maximum force tolerance for ionic relaxation.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        Returns</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        -------</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        float</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">            Maximum force tolerance (eV/Å).</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="nd">@fmax</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        Set the maximum force tolerance for ionic relaxation.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        Parameters</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        ----------</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        fmax : float</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">            Maximum force tolerance (eV/Å).</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmax</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="nd">@property</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="k">def</span> <span class="nf">max_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        Get the maximum number of iterations for relaxation.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        Returns</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        -------</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        int</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">            Maximum number of iterations.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="nd">@max_iter</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="nf">max_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        Set the maximum number of iterations for relaxation.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        Parameters</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        ----------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        max_iter : int</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">            Maximum number of iterations.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_iter</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="nf">calc_static</span><span class="p">(</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="p">):</span>        
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Perform a static calculation.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        Parameters</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">        ----------</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relax_cell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_isolated_atoms</span><span class="o">=</span><span class="n">on_isolated_atoms</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s2">&quot;calc_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>   
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>       
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">calc_minimize</span><span class="p">(</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="n">ionic_force_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="n">n_print</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="n">relax_cell</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s1">&#39;relax.traj&#39;</span><span class="p">,</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="p">):</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">        Perform a structure relaxation (geometry optimization). More CHGNet parameters can be specified by </span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-structoptimizer](https://chgnet.lbl.gov/api#class-structoptimizer).</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        Parameters</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        ----------</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        ionic_force_tolerance : float, optional</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">            Convergence criterion for forces (default is 0.1 eV/Å).</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        max_iter : int, optional</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">            Maximum number of iterations (default is 500).</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">            Frequency of logging output (default is 1).</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        relax_cell : bool or None, optional</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">            Whether to allow relaxation of the simulation cell (default is True).</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        save_path : str or None, optional</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            Path to save the trajectory file (default is &#39;relax.traj&#39;).</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="n">ionic_energy_tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="n">ionic_force_tolerance</span><span class="o">=</span><span class="n">ionic_force_tolerance</span><span class="p">,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>            
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="p">)</span>       
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;relax_cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relax_cell</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_path</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;assign_magmoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                          
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span> 
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_print</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ionic_force_tolerance</span>        
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>    
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>    <span class="k">def</span> <span class="nf">_write_calc_minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        Write the calculation script for performing structure relaxation.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        This method generates a Python script that uses CHGNet for structure</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        relaxation and writes it to a file in the working directory.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model=chgnet&#39;</span><span class="p">]</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;optimizer_class&#39;</span><span class="p">,</span> <span class="s1">&#39;use_device&#39;</span><span class="p">,</span> <span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="n">model_params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;fmax=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,steps=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;max_iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;loginterval=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;relax_cell&#39;</span><span class="p">,</span> <span class="s1">&#39;ase_filter&#39;</span><span class="p">,</span> <span class="s1">&#39;save_path&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_feas_save_path&#39;</span><span class="p">]</span>        
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="n">fix_imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="n">fixes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="s1">&#39;fix_imports&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="n">fix_imports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_imports&#39;</span><span class="p">)</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="s1">&#39;fixes&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>                
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)]</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Fixes are neither string or array of strings. Ignoring&#39;</span><span class="p">)</span>         
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="s1">&#39;from chgnet.model import CHGNet, StructOptimizer&#39;</span><span class="p">,</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="s1">&#39;from ase.io import read&#39;</span><span class="p">,</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="s1">&#39;from ase.io.cif import write_cif&#39;</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>            <span class="s1">&#39;from ase.io.trajectory import Trajectory&#39;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="s1">&#39;from pymatgen.io.ase import AseAtomsAdaptor&#39;</span><span class="p">,</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="s1">&#39;chgnet = CHGNet.load()&#39;</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="n">fix_imports</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="s1">&#39;struct = read(&quot;structure.cif&quot;)&#39;</span><span class="p">]</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fixes</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="n">script</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;struct.set_constraint(</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="n">script</span> <span class="o">+=</span> <span class="p">[</span>            
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="s1">&#39;relaxer = StructOptimizer(&#39;</span> <span class="o">+</span> <span class="n">model_params</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="s1">&#39;result = relaxer.relax(struct,&#39;</span> <span class="o">+</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="s1">&#39;final_structure = result[&quot;final_structure&quot;]&#39;</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="s1">&#39;ase_structure = AseAtomsAdaptor.get_atoms(final_structure)&#39;</span><span class="p">,</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="s1">&#39;write_cif(&quot;final_structure.cif&quot;, ase_structure)&#39;</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="p">]</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;calc_script.py&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">calc_md</span><span class="p">(</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="n">n_ionic_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="n">time_step</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># in femto-seconds</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="n">n_print</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="c1"># taut: float | None = None,        </span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># taup: float | None = None,        </span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="n">trajectory</span><span class="o">=</span><span class="s2">&quot;md_run.traj&quot;</span><span class="p">,</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="n">logfile</span><span class="o">=</span><span class="s2">&quot;md_run.log&quot;</span><span class="p">,</span>        
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="n">starting_temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="n">ensemble</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nvt&quot;</span><span class="p">,</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="p">):</span>        
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        Set up and perform a molecular dynamics (MD) simulation. More CHGNet parameters can be specified by </span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-moleculardynamics](https://chgnet.lbl.gov/api#class-moleculardynamics).</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        Parameters</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        ----------</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        temperature : float, optional</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">            Target temperature of the simulation in Kelvin (default is 300 K).</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        pressure : float or None, optional</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">            Target pressure for the simulation in bar (default is None).</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        n_ionic_steps : int, optional</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">            Number of ionic steps to simulate (default is 100).</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        time_step : float, optional</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">            Time step for the simulation in femtoseconds (default is 2.0 fs).</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">            Frequency of printing simulation logs (default is 10).</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        temperature_damping_timescale : float, optional</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">            Timescale for temperature damping in femtoseconds (default is 100.0 fs).</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        pressure_damping_timescale : float or None, optional</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">            Timescale for pressure damping in femtoseconds (default is None).</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        trajectory : str, optional</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">            Name of the output trajectory file (default is &#39;md_run.traj&#39;).</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        logfile : str, optional</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">            Name of the output log file (default is &#39;md_run.log&#39;).</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        starting_temperature : int or None, optional</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">            Initial temperature of the simulation (default is the target temperature).</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        ensemble : str, optional</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            Ensemble type, e.g., &#39;nvt&#39; or &#39;npt&#39; (default is &#39;nvt&#39;).</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_md</span><span class="p">(</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">n_ionic_steps</span><span class="o">=</span><span class="n">n_ionic_steps</span><span class="p">,</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">,</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="n">n_print</span><span class="o">=</span><span class="n">n_print</span><span class="p">,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="n">temperature_damping_timescale</span><span class="p">,</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="n">pressure_damping_timescale</span><span class="p">,</span>            
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;ensemble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ensemble</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logfile</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="n">starting_temperature</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="n">starting_temperature</span><span class="o">=</span><span class="n">temperature</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;starting_temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_temperature</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>    <span class="k">def</span> <span class="nf">_write_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        Write the calculation script for performing molecular dynamics (MD).</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        This method generates a Python script that uses CHGNet for running MD</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        simulations and writes it to a file in the working directory.</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;temperature=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,pressure=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,timestep=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;time_step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;loginterval=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,taut=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;temperature_damping_timescale&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,taup=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;pressure_damping_timescale&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ensemble&#39;</span><span class="p">,</span> <span class="s1">&#39;thermostat&#39;</span><span class="p">,</span> <span class="s1">&#39;starting_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;bulk_modulus&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_feas_logfile&#39;</span><span class="p">,</span> <span class="s1">&#39;append_trajectory&#39;</span><span class="p">,</span> <span class="s1">&#39;use_device&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">,</span> <span class="s1">&#39;logfile&#39;</span><span class="p">,</span> <span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span>                   
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">v</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="n">fix_imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="n">fixes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="s1">&#39;fix_imports&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>            <span class="n">fix_imports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_imports&#39;</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="s1">&#39;fixes&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>                
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)]</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Fixes are neither string or array of strings. Ignoring&#39;</span><span class="p">)</span> 
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                    
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="s1">&#39;from chgnet.model import CHGNet, MolecularDynamics&#39;</span><span class="p">,</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="s1">&#39;chgnet = CHGNet.load()&#39;</span><span class="p">,</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="s1">&#39;from ase.io import read&#39;</span><span class="p">,</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="s1">&#39;from ase.io.cif import write_cif&#39;</span><span class="p">,</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="n">fix_imports</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="s1">&#39;struct = read(&quot;structure.cif&quot;)&#39;</span><span class="p">]</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fixes</span><span class="p">:</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="n">script</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;struct.set_constraint(</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="n">script</span> <span class="o">+=</span> <span class="p">[</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="s1">&#39;md = MolecularDynamics(atoms=struct,model=chgnet,&#39;</span><span class="o">+</span><span class="n">params</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="sa">f</span><span class="s1">&#39;md.run(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s2">&quot;n_ionic_steps&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>            
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="s1">&#39;traj = read(f&quot;md_run.traj&quot;, index=&quot;:&quot;)&#39;</span><span class="p">,</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>            <span class="s1">&#39;write_cif(&quot;final_structure.cif&quot;, traj[-1])&#39;</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="p">]</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;calc_script.py&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="k">def</span> <span class="nf">write_input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        Write input files required for the CHGNet calculation.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">        This function writes the structure file (`structure.cif`), stores the input </span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">        dictionary to the HDF5 format, and delegates further writing depending on the </span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        calculation mode (MD or static/minimize).</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        Returns</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">        -------</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">        None</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;structure.cif&#39;</span><span class="p">),</span> <span class="n">pyiron_to_ase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">))</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_md</span><span class="p">()</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="c1"># calc_mode = static is treated as minimize with only a single ioninc step</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_minimize</span><span class="p">()</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>    <span class="k">def</span> <span class="nf">_parse_calc_static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;error.out&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        Parse the output of a static calculation.</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        This function reads the static calculation output file and returns the </span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">        corresponding DataFrame containing the optimization step and energy information.</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        Parameters</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        ----------</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        output : str, optional</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">            The name of the output file to parse, by default &#39;error.out&#39;.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        skip : int, optional</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">            The number of rows to skip at the start of the file, by default 3.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        Returns</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        -------</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        pd.DataFrame or None</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">            A DataFrame containing the optimization results, or None if parsing fails.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="n">header</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span> 
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="n">nrows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="n">skip</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>                <span class="n">header</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;optimizer_class&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">columns</span><span class="p">[:])</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>    <span class="k">def</span> <span class="nf">_parse_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;md_run.log&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        Parse the output of a molecular dynamics (MD) simulation.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        This function reads the MD log file and returns the corresponding DataFrame </span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        containing time, total energy, potential energy, kinetic energy, and temperature.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        Parameters</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        ----------</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        output : str, optional</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">            The name of the MD log file to parse, by default &#39;md_run.log&#39;.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        Returns</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        -------</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        pd.DataFrame or None</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">            A DataFrame containing the MD simulation results, or None if parsing fails.</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="k">try</span><span class="p">:</span>            
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>            <span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Etot&#39;</span><span class="p">,</span> <span class="s1">&#39;Epot&#39;</span><span class="p">,</span> <span class="s1">&#39;Ekin&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">collect_output</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">        Collect and store the results of the calculation.</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        This function parses the final structure, trajectory, and other output properties,</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        and stores them in the HDF5 format. The structure is updated, and various properties </span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        such as energies, forces, and magnetization are saved to the output group.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        Returns</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        -------</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">        None</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                    
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="n">relaxed_ase_structure</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;final_structure.cif&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;cif&#39;</span><span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="n">relaxed_pyiron_structure</span> <span class="o">=</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">relaxed_ase_structure</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="c1"># Store the relaxed structure in the HDF5 group</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>  <span class="c1"># Update the job&#39;s structure</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="c1"># Parse trajectory        </span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>                    <span class="n">traj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>                   
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;atom_positions&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/dft&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;magnetization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;magmoms&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>            
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>                <span class="n">traj</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_stress</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_forces</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="c1"># Parse other properties</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>            
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_static</span><span class="p">()</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Step&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">])</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Epot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Etot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>                
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_kin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ekin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">finished</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atoms</span><span class="p">:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        Retrieve the structure at a given frame from the calculation output.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        This function returns the atomic structure (positions, cell, species) at the </span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        specified frame index. The frame index is adjusted to ensure it is valid.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        Parameters</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        ----------</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        frame : int, optional</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            The frame index to retrieve. If negative, it is counted from the last frame, </span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">            by default -1.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        Returns</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        -------</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        Atoms</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">            The ASE Atoms object representing the structure at the given frame.</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        Raises</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        ------</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        ValueError</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">            If no structures are found in the job output.</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        IndexError</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">            If the frame index is out of range.</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>        <span class="n">num_structures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_structures</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="k">if</span> <span class="n">num_structures</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No structures found in the job output.&quot;</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="c1"># Ensure frame is valid</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>            <span class="n">frame</span> <span class="o">+=</span> <span class="n">num_structures</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&gt;=</span> <span class="n">num_structures</span><span class="p">:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                <span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">frame</span><span class="si">}</span><span class="s2"> is out of range for </span><span class="si">{</span><span class="n">num_structures</span><span class="si">}</span><span class="s2"> structures.&quot;</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>            <span class="n">positions</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>            <span class="n">cell</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>            
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="c1"># Read positions and cell</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/structure&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="n">species</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">]</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="c1"># Generate symbols list</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">species</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>        <span class="k">return</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">Atoms</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="k">class</span> <span class="nc">CalcParams</span><span class="p">(</span><span class="n">GenericParameters</span><span class="p">):</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">    Class to manage the calculation parameters for CHGNet calculations.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">    This class extends from `GenericParameters` and is used to define and manage </span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">    parameters specific to CHGNet calculations. It allows for initialization of </span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">    parameters and stores them in a table, with a default table name of &quot;chgnet&quot;. </span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">    The class can be used to load and store various CHGNet calculation settings and </span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">    other related configurations.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">    Parameters</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">    ----------</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">    table_name : str, optional</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">        The name of the table where the parameters are stored. By default, it is set </span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        to &quot;chgnet&quot;, but it can be customized if necessary.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">    </span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">    Methods</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">    -------</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">    __init__(self, table_name=&quot;chgnet&quot;)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="sd">        Initializes the parameters for the calculation.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>    
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;chgnet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">        Initialize the CalcParams object with the given table name.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        Parameters</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        ----------</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        table_name : str, optional</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">            The name of the table where the parameters are stored. By default, </span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">            it is set to &quot;chgnet&quot;.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CalcParams</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>            <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="p">)</span>
</span></pre></div>


            </section>
                <section id="CHGNet">
                            <input id="CHGNet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CHGNet</span><wbr>(<span class="base">pyiron_atomistics.atomistics.job.atomistic.AtomisticGenericJob</span>):

                <label class="view-source-button" for="CHGNet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet-23"><a href="#CHGNet-23"><span class="linenos"> 23</span></a><span class="k">class</span> <span class="nc">CHGNet</span><span class="p">(</span><span class="n">AtomisticGenericJob</span><span class="p">):</span>
</span><span id="CHGNet-24"><a href="#CHGNet-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-25"><a href="#CHGNet-25"><span class="linenos"> 25</span></a><span class="sd">    Custom job class for using CHGNet within the pyiron framework.</span>
</span><span id="CHGNet-26"><a href="#CHGNet-26"><span class="linenos"> 26</span></a>
</span><span id="CHGNet-27"><a href="#CHGNet-27"><span class="linenos"> 27</span></a><span class="sd">    This class provides methods to perform static calculations, structure relaxation,</span>
</span><span id="CHGNet-28"><a href="#CHGNet-28"><span class="linenos"> 28</span></a><span class="sd">    and molecular dynamics simulations using CHGNet.</span>
</span><span id="CHGNet-29"><a href="#CHGNet-29"><span class="linenos"> 29</span></a>
</span><span id="CHGNet-30"><a href="#CHGNet-30"><span class="linenos"> 30</span></a><span class="sd">    Attributes</span>
</span><span id="CHGNet-31"><a href="#CHGNet-31"><span class="linenos"> 31</span></a><span class="sd">    ----------</span>
</span><span id="CHGNet-32"><a href="#CHGNet-32"><span class="linenos"> 32</span></a><span class="sd">    structure : pyiron.atomistics.structure.atoms.Atoms</span>
</span><span id="CHGNet-33"><a href="#CHGNet-33"><span class="linenos"> 33</span></a><span class="sd">        Structure associated with the job.</span>
</span><span id="CHGNet-34"><a href="#CHGNet-34"><span class="linenos"> 34</span></a><span class="sd">    input : CalcParams</span>
</span><span id="CHGNet-35"><a href="#CHGNet-35"><span class="linenos"> 35</span></a><span class="sd">        Input parameters for the CHGNet calculations.</span>
</span><span id="CHGNet-36"><a href="#CHGNet-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CHGNet-37"><a href="#CHGNet-37"><span class="linenos"> 37</span></a>
</span><span id="CHGNet-38"><a href="#CHGNet-38"><span class="linenos"> 38</span></a>
</span><span id="CHGNet-39"><a href="#CHGNet-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
</span><span id="CHGNet-40"><a href="#CHGNet-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-41"><a href="#CHGNet-41"><span class="linenos"> 41</span></a><span class="sd">        Initialize the CHGNet job.</span>
</span><span id="CHGNet-42"><a href="#CHGNet-42"><span class="linenos"> 42</span></a>
</span><span id="CHGNet-43"><a href="#CHGNet-43"><span class="linenos"> 43</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-44"><a href="#CHGNet-44"><span class="linenos"> 44</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-45"><a href="#CHGNet-45"><span class="linenos"> 45</span></a><span class="sd">        project : pyiron.Project</span>
</span><span id="CHGNet-46"><a href="#CHGNet-46"><span class="linenos"> 46</span></a><span class="sd">            The pyiron project in which the job resides.</span>
</span><span id="CHGNet-47"><a href="#CHGNet-47"><span class="linenos"> 47</span></a><span class="sd">        job_name : str</span>
</span><span id="CHGNet-48"><a href="#CHGNet-48"><span class="linenos"> 48</span></a><span class="sd">            Name of the job.</span>
</span><span id="CHGNet-49"><a href="#CHGNet-49"><span class="linenos"> 49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-50"><a href="#CHGNet-50"><span class="linenos"> 50</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CHGNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
</span><span id="CHGNet-51"><a href="#CHGNet-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CHGNet-52"><a href="#CHGNet-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">CalcParams</span><span class="p">()</span>
</span><span id="CHGNet-53"><a href="#CHGNet-53"><span class="linenos"> 53</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">file_exists</span><span class="p">:</span>
</span><span id="CHGNet-54"><a href="#CHGNet-54"><span class="linenos"> 54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">from_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="CHGNet-55"><a href="#CHGNet-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_executable_activate</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s1">&#39;chgnet&#39;</span><span class="p">)</span>            
</span><span id="CHGNet-56"><a href="#CHGNet-56"><span class="linenos"> 56</span></a>
</span><span id="CHGNet-57"><a href="#CHGNet-57"><span class="linenos"> 57</span></a>    <span class="nd">@property</span>
</span><span id="CHGNet-58"><a href="#CHGNet-58"><span class="linenos"> 58</span></a>    <span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CHGNet-59"><a href="#CHGNet-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-60"><a href="#CHGNet-60"><span class="linenos"> 60</span></a><span class="sd">        Get the maximum force tolerance for ionic relaxation.</span>
</span><span id="CHGNet-61"><a href="#CHGNet-61"><span class="linenos"> 61</span></a>
</span><span id="CHGNet-62"><a href="#CHGNet-62"><span class="linenos"> 62</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-63"><a href="#CHGNet-63"><span class="linenos"> 63</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-64"><a href="#CHGNet-64"><span class="linenos"> 64</span></a><span class="sd">        float</span>
</span><span id="CHGNet-65"><a href="#CHGNet-65"><span class="linenos"> 65</span></a><span class="sd">            Maximum force tolerance (eV/Å).</span>
</span><span id="CHGNet-66"><a href="#CHGNet-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-67"><a href="#CHGNet-67"><span class="linenos"> 67</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span>
</span><span id="CHGNet-68"><a href="#CHGNet-68"><span class="linenos"> 68</span></a>
</span><span id="CHGNet-69"><a href="#CHGNet-69"><span class="linenos"> 69</span></a>    <span class="nd">@fmax</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CHGNet-70"><a href="#CHGNet-70"><span class="linenos"> 70</span></a>    <span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="CHGNet-71"><a href="#CHGNet-71"><span class="linenos"> 71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-72"><a href="#CHGNet-72"><span class="linenos"> 72</span></a><span class="sd">        Set the maximum force tolerance for ionic relaxation.</span>
</span><span id="CHGNet-73"><a href="#CHGNet-73"><span class="linenos"> 73</span></a>
</span><span id="CHGNet-74"><a href="#CHGNet-74"><span class="linenos"> 74</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-75"><a href="#CHGNet-75"><span class="linenos"> 75</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-76"><a href="#CHGNet-76"><span class="linenos"> 76</span></a><span class="sd">        fmax : float</span>
</span><span id="CHGNet-77"><a href="#CHGNet-77"><span class="linenos"> 77</span></a><span class="sd">            Maximum force tolerance (eV/Å).</span>
</span><span id="CHGNet-78"><a href="#CHGNet-78"><span class="linenos"> 78</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-79"><a href="#CHGNet-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fmax</span>
</span><span id="CHGNet-80"><a href="#CHGNet-80"><span class="linenos"> 80</span></a>
</span><span id="CHGNet-81"><a href="#CHGNet-81"><span class="linenos"> 81</span></a>    <span class="nd">@property</span>
</span><span id="CHGNet-82"><a href="#CHGNet-82"><span class="linenos"> 82</span></a>    <span class="k">def</span> <span class="nf">max_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CHGNet-83"><a href="#CHGNet-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-84"><a href="#CHGNet-84"><span class="linenos"> 84</span></a><span class="sd">        Get the maximum number of iterations for relaxation.</span>
</span><span id="CHGNet-85"><a href="#CHGNet-85"><span class="linenos"> 85</span></a>
</span><span id="CHGNet-86"><a href="#CHGNet-86"><span class="linenos"> 86</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-87"><a href="#CHGNet-87"><span class="linenos"> 87</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-88"><a href="#CHGNet-88"><span class="linenos"> 88</span></a><span class="sd">        int</span>
</span><span id="CHGNet-89"><a href="#CHGNet-89"><span class="linenos"> 89</span></a><span class="sd">            Maximum number of iterations.</span>
</span><span id="CHGNet-90"><a href="#CHGNet-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-91"><a href="#CHGNet-91"><span class="linenos"> 91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span>
</span><span id="CHGNet-92"><a href="#CHGNet-92"><span class="linenos"> 92</span></a>
</span><span id="CHGNet-93"><a href="#CHGNet-93"><span class="linenos"> 93</span></a>    <span class="nd">@max_iter</span><span class="o">.</span><span class="n">setter</span>
</span><span id="CHGNet-94"><a href="#CHGNet-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="nf">max_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="CHGNet-95"><a href="#CHGNet-95"><span class="linenos"> 95</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-96"><a href="#CHGNet-96"><span class="linenos"> 96</span></a><span class="sd">        Set the maximum number of iterations for relaxation.</span>
</span><span id="CHGNet-97"><a href="#CHGNet-97"><span class="linenos"> 97</span></a>
</span><span id="CHGNet-98"><a href="#CHGNet-98"><span class="linenos"> 98</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-99"><a href="#CHGNet-99"><span class="linenos"> 99</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-100"><a href="#CHGNet-100"><span class="linenos">100</span></a><span class="sd">        max_iter : int</span>
</span><span id="CHGNet-101"><a href="#CHGNet-101"><span class="linenos">101</span></a><span class="sd">            Maximum number of iterations.</span>
</span><span id="CHGNet-102"><a href="#CHGNet-102"><span class="linenos">102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-103"><a href="#CHGNet-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_iter</span>
</span><span id="CHGNet-104"><a href="#CHGNet-104"><span class="linenos">104</span></a>
</span><span id="CHGNet-105"><a href="#CHGNet-105"><span class="linenos">105</span></a>        
</span><span id="CHGNet-106"><a href="#CHGNet-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="nf">calc_static</span><span class="p">(</span>
</span><span id="CHGNet-107"><a href="#CHGNet-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet-108"><a href="#CHGNet-108"><span class="linenos">108</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet-109"><a href="#CHGNet-109"><span class="linenos">109</span></a>    <span class="p">):</span>        
</span><span id="CHGNet-110"><a href="#CHGNet-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-111"><a href="#CHGNet-111"><span class="linenos">111</span></a><span class="sd">        Perform a static calculation.</span>
</span><span id="CHGNet-112"><a href="#CHGNet-112"><span class="linenos">112</span></a>
</span><span id="CHGNet-113"><a href="#CHGNet-113"><span class="linenos">113</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-114"><a href="#CHGNet-114"><span class="linenos">114</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-115"><a href="#CHGNet-115"><span class="linenos">115</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet-116"><a href="#CHGNet-116"><span class="linenos">116</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet-117"><a href="#CHGNet-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-118"><a href="#CHGNet-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relax_cell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_isolated_atoms</span><span class="o">=</span><span class="n">on_isolated_atoms</span><span class="p">)</span>
</span><span id="CHGNet-119"><a href="#CHGNet-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s2">&quot;calc_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>   
</span><span id="CHGNet-120"><a href="#CHGNet-120"><span class="linenos">120</span></a>       
</span><span id="CHGNet-121"><a href="#CHGNet-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">calc_minimize</span><span class="p">(</span>
</span><span id="CHGNet-122"><a href="#CHGNet-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet-123"><a href="#CHGNet-123"><span class="linenos">123</span></a>        <span class="n">ionic_force_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="CHGNet-124"><a href="#CHGNet-124"><span class="linenos">124</span></a>        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="CHGNet-125"><a href="#CHGNet-125"><span class="linenos">125</span></a>        <span class="n">n_print</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="CHGNet-126"><a href="#CHGNet-126"><span class="linenos">126</span></a>        <span class="n">relax_cell</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="CHGNet-127"><a href="#CHGNet-127"><span class="linenos">127</span></a>        <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s1">&#39;relax.traj&#39;</span><span class="p">,</span>
</span><span id="CHGNet-128"><a href="#CHGNet-128"><span class="linenos">128</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet-129"><a href="#CHGNet-129"><span class="linenos">129</span></a>    <span class="p">):</span>
</span><span id="CHGNet-130"><a href="#CHGNet-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-131"><a href="#CHGNet-131"><span class="linenos">131</span></a><span class="sd">        Perform a structure relaxation (geometry optimization). More CHGNet parameters can be specified by </span>
</span><span id="CHGNet-132"><a href="#CHGNet-132"><span class="linenos">132</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="CHGNet-133"><a href="#CHGNet-133"><span class="linenos">133</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-structoptimizer](https://chgnet.lbl.gov/api#class-structoptimizer).</span>
</span><span id="CHGNet-134"><a href="#CHGNet-134"><span class="linenos">134</span></a>
</span><span id="CHGNet-135"><a href="#CHGNet-135"><span class="linenos">135</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-136"><a href="#CHGNet-136"><span class="linenos">136</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-137"><a href="#CHGNet-137"><span class="linenos">137</span></a><span class="sd">        ionic_force_tolerance : float, optional</span>
</span><span id="CHGNet-138"><a href="#CHGNet-138"><span class="linenos">138</span></a><span class="sd">            Convergence criterion for forces (default is 0.1 eV/Å).</span>
</span><span id="CHGNet-139"><a href="#CHGNet-139"><span class="linenos">139</span></a><span class="sd">        max_iter : int, optional</span>
</span><span id="CHGNet-140"><a href="#CHGNet-140"><span class="linenos">140</span></a><span class="sd">            Maximum number of iterations (default is 500).</span>
</span><span id="CHGNet-141"><a href="#CHGNet-141"><span class="linenos">141</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="CHGNet-142"><a href="#CHGNet-142"><span class="linenos">142</span></a><span class="sd">            Frequency of logging output (default is 1).</span>
</span><span id="CHGNet-143"><a href="#CHGNet-143"><span class="linenos">143</span></a><span class="sd">        relax_cell : bool or None, optional</span>
</span><span id="CHGNet-144"><a href="#CHGNet-144"><span class="linenos">144</span></a><span class="sd">            Whether to allow relaxation of the simulation cell (default is True).</span>
</span><span id="CHGNet-145"><a href="#CHGNet-145"><span class="linenos">145</span></a><span class="sd">        save_path : str or None, optional</span>
</span><span id="CHGNet-146"><a href="#CHGNet-146"><span class="linenos">146</span></a><span class="sd">            Path to save the trajectory file (default is &#39;relax.traj&#39;).</span>
</span><span id="CHGNet-147"><a href="#CHGNet-147"><span class="linenos">147</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet-148"><a href="#CHGNet-148"><span class="linenos">148</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet-149"><a href="#CHGNet-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-150"><a href="#CHGNet-150"><span class="linenos">150</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span>
</span><span id="CHGNet-151"><a href="#CHGNet-151"><span class="linenos">151</span></a>            <span class="n">ionic_energy_tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="CHGNet-152"><a href="#CHGNet-152"><span class="linenos">152</span></a>            <span class="n">ionic_force_tolerance</span><span class="o">=</span><span class="n">ionic_force_tolerance</span><span class="p">,</span>
</span><span id="CHGNet-153"><a href="#CHGNet-153"><span class="linenos">153</span></a>            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>            
</span><span id="CHGNet-154"><a href="#CHGNet-154"><span class="linenos">154</span></a>        <span class="p">)</span>       
</span><span id="CHGNet-155"><a href="#CHGNet-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;relax_cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relax_cell</span>
</span><span id="CHGNet-156"><a href="#CHGNet-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_path</span>
</span><span id="CHGNet-157"><a href="#CHGNet-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CHGNet-158"><a href="#CHGNet-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;assign_magmoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                          
</span><span id="CHGNet-159"><a href="#CHGNet-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span> 
</span><span id="CHGNet-160"><a href="#CHGNet-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_print</span>
</span><span id="CHGNet-161"><a href="#CHGNet-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ionic_force_tolerance</span>        
</span><span id="CHGNet-162"><a href="#CHGNet-162"><span class="linenos">162</span></a>    
</span><span id="CHGNet-163"><a href="#CHGNet-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">_write_calc_minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CHGNet-164"><a href="#CHGNet-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-165"><a href="#CHGNet-165"><span class="linenos">165</span></a><span class="sd">        Write the calculation script for performing structure relaxation.</span>
</span><span id="CHGNet-166"><a href="#CHGNet-166"><span class="linenos">166</span></a>
</span><span id="CHGNet-167"><a href="#CHGNet-167"><span class="linenos">167</span></a><span class="sd">        This method generates a Python script that uses CHGNet for structure</span>
</span><span id="CHGNet-168"><a href="#CHGNet-168"><span class="linenos">168</span></a><span class="sd">        relaxation and writes it to a file in the working directory.</span>
</span><span id="CHGNet-169"><a href="#CHGNet-169"><span class="linenos">169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-170"><a href="#CHGNet-170"><span class="linenos">170</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model=chgnet&#39;</span><span class="p">]</span>
</span><span id="CHGNet-171"><a href="#CHGNet-171"><span class="linenos">171</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;optimizer_class&#39;</span><span class="p">,</span> <span class="s1">&#39;use_device&#39;</span><span class="p">,</span> <span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span>
</span><span id="CHGNet-172"><a href="#CHGNet-172"><span class="linenos">172</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-173"><a href="#CHGNet-173"><span class="linenos">173</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="CHGNet-174"><a href="#CHGNet-174"><span class="linenos">174</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-175"><a href="#CHGNet-175"><span class="linenos">175</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CHGNet-176"><a href="#CHGNet-176"><span class="linenos">176</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CHGNet-177"><a href="#CHGNet-177"><span class="linenos">177</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-178"><a href="#CHGNet-178"><span class="linenos">178</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="CHGNet-179"><a href="#CHGNet-179"><span class="linenos">179</span></a>        <span class="n">model_params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="CHGNet-180"><a href="#CHGNet-180"><span class="linenos">180</span></a>
</span><span id="CHGNet-181"><a href="#CHGNet-181"><span class="linenos">181</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CHGNet-182"><a href="#CHGNet-182"><span class="linenos">182</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;fmax=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,steps=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;max_iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="CHGNet-183"><a href="#CHGNet-183"><span class="linenos">183</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;loginterval=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="CHGNet-184"><a href="#CHGNet-184"><span class="linenos">184</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;relax_cell&#39;</span><span class="p">,</span> <span class="s1">&#39;ase_filter&#39;</span><span class="p">,</span> <span class="s1">&#39;save_path&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_feas_save_path&#39;</span><span class="p">]</span>        
</span><span id="CHGNet-185"><a href="#CHGNet-185"><span class="linenos">185</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-186"><a href="#CHGNet-186"><span class="linenos">186</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="CHGNet-187"><a href="#CHGNet-187"><span class="linenos">187</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-188"><a href="#CHGNet-188"><span class="linenos">188</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CHGNet-189"><a href="#CHGNet-189"><span class="linenos">189</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">v</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CHGNet-190"><a href="#CHGNet-190"><span class="linenos">190</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-191"><a href="#CHGNet-191"><span class="linenos">191</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="CHGNet-192"><a href="#CHGNet-192"><span class="linenos">192</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="CHGNet-193"><a href="#CHGNet-193"><span class="linenos">193</span></a>        <span class="n">fix_imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="CHGNet-194"><a href="#CHGNet-194"><span class="linenos">194</span></a>        <span class="n">fixes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CHGNet-195"><a href="#CHGNet-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="s1">&#39;fix_imports&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-196"><a href="#CHGNet-196"><span class="linenos">196</span></a>            <span class="n">fix_imports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_imports&#39;</span><span class="p">)</span>
</span><span id="CHGNet-197"><a href="#CHGNet-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="s1">&#39;fixes&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-198"><a href="#CHGNet-198"><span class="linenos">198</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)</span>
</span><span id="CHGNet-199"><a href="#CHGNet-199"><span class="linenos">199</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>                
</span><span id="CHGNet-200"><a href="#CHGNet-200"><span class="linenos">200</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)]</span>
</span><span id="CHGNet-201"><a href="#CHGNet-201"><span class="linenos">201</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="CHGNet-202"><a href="#CHGNet-202"><span class="linenos">202</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="CHGNet-203"><a href="#CHGNet-203"><span class="linenos">203</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-204"><a href="#CHGNet-204"><span class="linenos">204</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Fixes are neither string or array of strings. Ignoring&#39;</span><span class="p">)</span>         
</span><span id="CHGNet-205"><a href="#CHGNet-205"><span class="linenos">205</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CHGNet-206"><a href="#CHGNet-206"><span class="linenos">206</span></a>            <span class="s1">&#39;from chgnet.model import CHGNet, StructOptimizer&#39;</span><span class="p">,</span>
</span><span id="CHGNet-207"><a href="#CHGNet-207"><span class="linenos">207</span></a>            <span class="s1">&#39;from ase.io import read&#39;</span><span class="p">,</span>
</span><span id="CHGNet-208"><a href="#CHGNet-208"><span class="linenos">208</span></a>            <span class="s1">&#39;from ase.io.cif import write_cif&#39;</span><span class="p">,</span>
</span><span id="CHGNet-209"><a href="#CHGNet-209"><span class="linenos">209</span></a>            <span class="s1">&#39;from ase.io.trajectory import Trajectory&#39;</span><span class="p">,</span>
</span><span id="CHGNet-210"><a href="#CHGNet-210"><span class="linenos">210</span></a>            <span class="s1">&#39;from pymatgen.io.ase import AseAtomsAdaptor&#39;</span><span class="p">,</span>
</span><span id="CHGNet-211"><a href="#CHGNet-211"><span class="linenos">211</span></a>            <span class="s1">&#39;chgnet = CHGNet.load()&#39;</span><span class="p">,</span>
</span><span id="CHGNet-212"><a href="#CHGNet-212"><span class="linenos">212</span></a>            <span class="n">fix_imports</span><span class="p">,</span>
</span><span id="CHGNet-213"><a href="#CHGNet-213"><span class="linenos">213</span></a>            <span class="s1">&#39;struct = read(&quot;structure.cif&quot;)&#39;</span><span class="p">]</span>
</span><span id="CHGNet-214"><a href="#CHGNet-214"><span class="linenos">214</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fixes</span><span class="p">:</span>
</span><span id="CHGNet-215"><a href="#CHGNet-215"><span class="linenos">215</span></a>            <span class="n">script</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;struct.set_constraint(</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="CHGNet-216"><a href="#CHGNet-216"><span class="linenos">216</span></a>        <span class="n">script</span> <span class="o">+=</span> <span class="p">[</span>            
</span><span id="CHGNet-217"><a href="#CHGNet-217"><span class="linenos">217</span></a>            <span class="s1">&#39;relaxer = StructOptimizer(&#39;</span> <span class="o">+</span> <span class="n">model_params</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="CHGNet-218"><a href="#CHGNet-218"><span class="linenos">218</span></a>            <span class="s1">&#39;result = relaxer.relax(struct,&#39;</span> <span class="o">+</span> <span class="n">params</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="CHGNet-219"><a href="#CHGNet-219"><span class="linenos">219</span></a>            <span class="s1">&#39;final_structure = result[&quot;final_structure&quot;]&#39;</span><span class="p">,</span>
</span><span id="CHGNet-220"><a href="#CHGNet-220"><span class="linenos">220</span></a>            <span class="s1">&#39;ase_structure = AseAtomsAdaptor.get_atoms(final_structure)&#39;</span><span class="p">,</span>
</span><span id="CHGNet-221"><a href="#CHGNet-221"><span class="linenos">221</span></a>            <span class="s1">&#39;write_cif(&quot;final_structure.cif&quot;, ase_structure)&#39;</span>
</span><span id="CHGNet-222"><a href="#CHGNet-222"><span class="linenos">222</span></a>        <span class="p">]</span>
</span><span id="CHGNet-223"><a href="#CHGNet-223"><span class="linenos">223</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;calc_script.py&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CHGNet-224"><a href="#CHGNet-224"><span class="linenos">224</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</span><span id="CHGNet-225"><a href="#CHGNet-225"><span class="linenos">225</span></a>            
</span><span id="CHGNet-226"><a href="#CHGNet-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">calc_md</span><span class="p">(</span>
</span><span id="CHGNet-227"><a href="#CHGNet-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet-228"><a href="#CHGNet-228"><span class="linenos">228</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="CHGNet-229"><a href="#CHGNet-229"><span class="linenos">229</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CHGNet-230"><a href="#CHGNet-230"><span class="linenos">230</span></a>        <span class="n">n_ionic_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CHGNet-231"><a href="#CHGNet-231"><span class="linenos">231</span></a>        <span class="n">time_step</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># in femto-seconds</span>
</span><span id="CHGNet-232"><a href="#CHGNet-232"><span class="linenos">232</span></a>        <span class="n">n_print</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="CHGNet-233"><a href="#CHGNet-233"><span class="linenos">233</span></a>        <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="c1"># taut: float | None = None,        </span>
</span><span id="CHGNet-234"><a href="#CHGNet-234"><span class="linenos">234</span></a>        <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># taup: float | None = None,        </span>
</span><span id="CHGNet-235"><a href="#CHGNet-235"><span class="linenos">235</span></a>        <span class="n">trajectory</span><span class="o">=</span><span class="s2">&quot;md_run.traj&quot;</span><span class="p">,</span>
</span><span id="CHGNet-236"><a href="#CHGNet-236"><span class="linenos">236</span></a>        <span class="n">logfile</span><span class="o">=</span><span class="s2">&quot;md_run.log&quot;</span><span class="p">,</span>        
</span><span id="CHGNet-237"><a href="#CHGNet-237"><span class="linenos">237</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet-238"><a href="#CHGNet-238"><span class="linenos">238</span></a>        <span class="n">starting_temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CHGNet-239"><a href="#CHGNet-239"><span class="linenos">239</span></a>        <span class="n">ensemble</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nvt&quot;</span><span class="p">,</span>
</span><span id="CHGNet-240"><a href="#CHGNet-240"><span class="linenos">240</span></a>    <span class="p">):</span>        
</span><span id="CHGNet-241"><a href="#CHGNet-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-242"><a href="#CHGNet-242"><span class="linenos">242</span></a><span class="sd">        Set up and perform a molecular dynamics (MD) simulation. More CHGNet parameters can be specified by </span>
</span><span id="CHGNet-243"><a href="#CHGNet-243"><span class="linenos">243</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="CHGNet-244"><a href="#CHGNet-244"><span class="linenos">244</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-moleculardynamics](https://chgnet.lbl.gov/api#class-moleculardynamics).</span>
</span><span id="CHGNet-245"><a href="#CHGNet-245"><span class="linenos">245</span></a>
</span><span id="CHGNet-246"><a href="#CHGNet-246"><span class="linenos">246</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-247"><a href="#CHGNet-247"><span class="linenos">247</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-248"><a href="#CHGNet-248"><span class="linenos">248</span></a><span class="sd">        temperature : float, optional</span>
</span><span id="CHGNet-249"><a href="#CHGNet-249"><span class="linenos">249</span></a><span class="sd">            Target temperature of the simulation in Kelvin (default is 300 K).</span>
</span><span id="CHGNet-250"><a href="#CHGNet-250"><span class="linenos">250</span></a><span class="sd">        pressure : float or None, optional</span>
</span><span id="CHGNet-251"><a href="#CHGNet-251"><span class="linenos">251</span></a><span class="sd">            Target pressure for the simulation in bar (default is None).</span>
</span><span id="CHGNet-252"><a href="#CHGNet-252"><span class="linenos">252</span></a><span class="sd">        n_ionic_steps : int, optional</span>
</span><span id="CHGNet-253"><a href="#CHGNet-253"><span class="linenos">253</span></a><span class="sd">            Number of ionic steps to simulate (default is 100).</span>
</span><span id="CHGNet-254"><a href="#CHGNet-254"><span class="linenos">254</span></a><span class="sd">        time_step : float, optional</span>
</span><span id="CHGNet-255"><a href="#CHGNet-255"><span class="linenos">255</span></a><span class="sd">            Time step for the simulation in femtoseconds (default is 2.0 fs).</span>
</span><span id="CHGNet-256"><a href="#CHGNet-256"><span class="linenos">256</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="CHGNet-257"><a href="#CHGNet-257"><span class="linenos">257</span></a><span class="sd">            Frequency of printing simulation logs (default is 10).</span>
</span><span id="CHGNet-258"><a href="#CHGNet-258"><span class="linenos">258</span></a><span class="sd">        temperature_damping_timescale : float, optional</span>
</span><span id="CHGNet-259"><a href="#CHGNet-259"><span class="linenos">259</span></a><span class="sd">            Timescale for temperature damping in femtoseconds (default is 100.0 fs).</span>
</span><span id="CHGNet-260"><a href="#CHGNet-260"><span class="linenos">260</span></a><span class="sd">        pressure_damping_timescale : float or None, optional</span>
</span><span id="CHGNet-261"><a href="#CHGNet-261"><span class="linenos">261</span></a><span class="sd">            Timescale for pressure damping in femtoseconds (default is None).</span>
</span><span id="CHGNet-262"><a href="#CHGNet-262"><span class="linenos">262</span></a><span class="sd">        trajectory : str, optional</span>
</span><span id="CHGNet-263"><a href="#CHGNet-263"><span class="linenos">263</span></a><span class="sd">            Name of the output trajectory file (default is &#39;md_run.traj&#39;).</span>
</span><span id="CHGNet-264"><a href="#CHGNet-264"><span class="linenos">264</span></a><span class="sd">        logfile : str, optional</span>
</span><span id="CHGNet-265"><a href="#CHGNet-265"><span class="linenos">265</span></a><span class="sd">            Name of the output log file (default is &#39;md_run.log&#39;).</span>
</span><span id="CHGNet-266"><a href="#CHGNet-266"><span class="linenos">266</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet-267"><a href="#CHGNet-267"><span class="linenos">267</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet-268"><a href="#CHGNet-268"><span class="linenos">268</span></a><span class="sd">        starting_temperature : int or None, optional</span>
</span><span id="CHGNet-269"><a href="#CHGNet-269"><span class="linenos">269</span></a><span class="sd">            Initial temperature of the simulation (default is the target temperature).</span>
</span><span id="CHGNet-270"><a href="#CHGNet-270"><span class="linenos">270</span></a><span class="sd">        ensemble : str, optional</span>
</span><span id="CHGNet-271"><a href="#CHGNet-271"><span class="linenos">271</span></a><span class="sd">            Ensemble type, e.g., &#39;nvt&#39; or &#39;npt&#39; (default is &#39;nvt&#39;).</span>
</span><span id="CHGNet-272"><a href="#CHGNet-272"><span class="linenos">272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-273"><a href="#CHGNet-273"><span class="linenos">273</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_md</span><span class="p">(</span>
</span><span id="CHGNet-274"><a href="#CHGNet-274"><span class="linenos">274</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="CHGNet-275"><a href="#CHGNet-275"><span class="linenos">275</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="CHGNet-276"><a href="#CHGNet-276"><span class="linenos">276</span></a>            <span class="n">n_ionic_steps</span><span class="o">=</span><span class="n">n_ionic_steps</span><span class="p">,</span>
</span><span id="CHGNet-277"><a href="#CHGNet-277"><span class="linenos">277</span></a>            <span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">,</span>
</span><span id="CHGNet-278"><a href="#CHGNet-278"><span class="linenos">278</span></a>            <span class="n">n_print</span><span class="o">=</span><span class="n">n_print</span><span class="p">,</span>
</span><span id="CHGNet-279"><a href="#CHGNet-279"><span class="linenos">279</span></a>            <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="n">temperature_damping_timescale</span><span class="p">,</span>
</span><span id="CHGNet-280"><a href="#CHGNet-280"><span class="linenos">280</span></a>            <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="n">pressure_damping_timescale</span><span class="p">,</span>            
</span><span id="CHGNet-281"><a href="#CHGNet-281"><span class="linenos">281</span></a>        <span class="p">)</span>
</span><span id="CHGNet-282"><a href="#CHGNet-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;ensemble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ensemble</span>
</span><span id="CHGNet-283"><a href="#CHGNet-283"><span class="linenos">283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
</span><span id="CHGNet-284"><a href="#CHGNet-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logfile</span>
</span><span id="CHGNet-285"><a href="#CHGNet-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span>
</span><span id="CHGNet-286"><a href="#CHGNet-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="n">starting_temperature</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-287"><a href="#CHGNet-287"><span class="linenos">287</span></a>            <span class="n">starting_temperature</span><span class="o">=</span><span class="n">temperature</span>
</span><span id="CHGNet-288"><a href="#CHGNet-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;starting_temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_temperature</span>
</span><span id="CHGNet-289"><a href="#CHGNet-289"><span class="linenos">289</span></a>
</span><span id="CHGNet-290"><a href="#CHGNet-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">_write_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
</span><span id="CHGNet-291"><a href="#CHGNet-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-292"><a href="#CHGNet-292"><span class="linenos">292</span></a><span class="sd">        Write the calculation script for performing molecular dynamics (MD).</span>
</span><span id="CHGNet-293"><a href="#CHGNet-293"><span class="linenos">293</span></a>
</span><span id="CHGNet-294"><a href="#CHGNet-294"><span class="linenos">294</span></a><span class="sd">        This method generates a Python script that uses CHGNet for running MD</span>
</span><span id="CHGNet-295"><a href="#CHGNet-295"><span class="linenos">295</span></a><span class="sd">        simulations and writes it to a file in the working directory.</span>
</span><span id="CHGNet-296"><a href="#CHGNet-296"><span class="linenos">296</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-297"><a href="#CHGNet-297"><span class="linenos">297</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CHGNet-298"><a href="#CHGNet-298"><span class="linenos">298</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;temperature=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,pressure=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,timestep=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;time_step&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="CHGNet-299"><a href="#CHGNet-299"><span class="linenos">299</span></a>        <span class="n">params</span> <span class="o">+=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;loginterval=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,taut=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;temperature_damping_timescale&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">,taup=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;pressure_damping_timescale&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
</span><span id="CHGNet-300"><a href="#CHGNet-300"><span class="linenos">300</span></a>        <span class="n">allowed_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ensemble&#39;</span><span class="p">,</span> <span class="s1">&#39;thermostat&#39;</span><span class="p">,</span> <span class="s1">&#39;starting_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;bulk_modulus&#39;</span><span class="p">,</span> <span class="s1">&#39;crystal_feas_logfile&#39;</span><span class="p">,</span> <span class="s1">&#39;append_trajectory&#39;</span><span class="p">,</span> <span class="s1">&#39;use_device&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">,</span> <span class="s1">&#39;logfile&#39;</span><span class="p">,</span> <span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span>                   
</span><span id="CHGNet-301"><a href="#CHGNet-301"><span class="linenos">301</span></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-302"><a href="#CHGNet-302"><span class="linenos">302</span></a>            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="CHGNet-303"><a href="#CHGNet-303"><span class="linenos">303</span></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">allowed_params</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-304"><a href="#CHGNet-304"><span class="linenos">304</span></a>                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="CHGNet-305"><a href="#CHGNet-305"><span class="linenos">305</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="s2">&quot;=</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">v</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="CHGNet-306"><a href="#CHGNet-306"><span class="linenos">306</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-307"><a href="#CHGNet-307"><span class="linenos">307</span></a>                    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="CHGNet-308"><a href="#CHGNet-308"><span class="linenos">308</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</span><span id="CHGNet-309"><a href="#CHGNet-309"><span class="linenos">309</span></a>        <span class="n">fix_imports</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="CHGNet-310"><a href="#CHGNet-310"><span class="linenos">310</span></a>        <span class="n">fixes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="CHGNet-311"><a href="#CHGNet-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="s1">&#39;fix_imports&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-312"><a href="#CHGNet-312"><span class="linenos">312</span></a>            <span class="n">fix_imports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fix_imports&#39;</span><span class="p">)</span>
</span><span id="CHGNet-313"><a href="#CHGNet-313"><span class="linenos">313</span></a>        <span class="k">if</span> <span class="s1">&#39;fixes&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="CHGNet-314"><a href="#CHGNet-314"><span class="linenos">314</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)</span>
</span><span id="CHGNet-315"><a href="#CHGNet-315"><span class="linenos">315</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>                
</span><span id="CHGNet-316"><a href="#CHGNet-316"><span class="linenos">316</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fixes&#39;</span><span class="p">)]</span>
</span><span id="CHGNet-317"><a href="#CHGNet-317"><span class="linenos">317</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="CHGNet-318"><a href="#CHGNet-318"><span class="linenos">318</span></a>                <span class="n">fixes</span> <span class="o">=</span> <span class="n">f</span>
</span><span id="CHGNet-319"><a href="#CHGNet-319"><span class="linenos">319</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-320"><a href="#CHGNet-320"><span class="linenos">320</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Fixes are neither string or array of strings. Ignoring&#39;</span><span class="p">)</span> 
</span><span id="CHGNet-321"><a href="#CHGNet-321"><span class="linenos">321</span></a>                    
</span><span id="CHGNet-322"><a href="#CHGNet-322"><span class="linenos">322</span></a>        <span class="n">script</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="CHGNet-323"><a href="#CHGNet-323"><span class="linenos">323</span></a>            <span class="s1">&#39;from chgnet.model import CHGNet, MolecularDynamics&#39;</span><span class="p">,</span>
</span><span id="CHGNet-324"><a href="#CHGNet-324"><span class="linenos">324</span></a>            <span class="s1">&#39;chgnet = CHGNet.load()&#39;</span><span class="p">,</span>
</span><span id="CHGNet-325"><a href="#CHGNet-325"><span class="linenos">325</span></a>            <span class="s1">&#39;from ase.io import read&#39;</span><span class="p">,</span>
</span><span id="CHGNet-326"><a href="#CHGNet-326"><span class="linenos">326</span></a>            <span class="s1">&#39;from ase.io.cif import write_cif&#39;</span><span class="p">,</span>
</span><span id="CHGNet-327"><a href="#CHGNet-327"><span class="linenos">327</span></a>            <span class="n">fix_imports</span><span class="p">,</span>
</span><span id="CHGNet-328"><a href="#CHGNet-328"><span class="linenos">328</span></a>            <span class="s1">&#39;struct = read(&quot;structure.cif&quot;)&#39;</span><span class="p">]</span>
</span><span id="CHGNet-329"><a href="#CHGNet-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fixes</span><span class="p">:</span>
</span><span id="CHGNet-330"><a href="#CHGNet-330"><span class="linenos">330</span></a>            <span class="n">script</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;struct.set_constraint(</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="CHGNet-331"><a href="#CHGNet-331"><span class="linenos">331</span></a>        <span class="n">script</span> <span class="o">+=</span> <span class="p">[</span>
</span><span id="CHGNet-332"><a href="#CHGNet-332"><span class="linenos">332</span></a>            <span class="s1">&#39;md = MolecularDynamics(atoms=struct,model=chgnet,&#39;</span><span class="o">+</span><span class="n">params</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">,</span>
</span><span id="CHGNet-333"><a href="#CHGNet-333"><span class="linenos">333</span></a>            <span class="sa">f</span><span class="s1">&#39;md.run(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s2">&quot;n_ionic_steps&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>            
</span><span id="CHGNet-334"><a href="#CHGNet-334"><span class="linenos">334</span></a>            <span class="s1">&#39;traj = read(f&quot;md_run.traj&quot;, index=&quot;:&quot;)&#39;</span><span class="p">,</span>
</span><span id="CHGNet-335"><a href="#CHGNet-335"><span class="linenos">335</span></a>            <span class="s1">&#39;write_cif(&quot;final_structure.cif&quot;, traj[-1])&#39;</span>
</span><span id="CHGNet-336"><a href="#CHGNet-336"><span class="linenos">336</span></a>        <span class="p">]</span>
</span><span id="CHGNet-337"><a href="#CHGNet-337"><span class="linenos">337</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;calc_script.py&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CHGNet-338"><a href="#CHGNet-338"><span class="linenos">338</span></a>            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script</span><span class="p">))</span>
</span><span id="CHGNet-339"><a href="#CHGNet-339"><span class="linenos">339</span></a>
</span><span id="CHGNet-340"><a href="#CHGNet-340"><span class="linenos">340</span></a>    <span class="k">def</span> <span class="nf">write_input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-341"><a href="#CHGNet-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-342"><a href="#CHGNet-342"><span class="linenos">342</span></a><span class="sd">        Write input files required for the CHGNet calculation.</span>
</span><span id="CHGNet-343"><a href="#CHGNet-343"><span class="linenos">343</span></a>
</span><span id="CHGNet-344"><a href="#CHGNet-344"><span class="linenos">344</span></a><span class="sd">        This function writes the structure file (`structure.cif`), stores the input </span>
</span><span id="CHGNet-345"><a href="#CHGNet-345"><span class="linenos">345</span></a><span class="sd">        dictionary to the HDF5 format, and delegates further writing depending on the </span>
</span><span id="CHGNet-346"><a href="#CHGNet-346"><span class="linenos">346</span></a><span class="sd">        calculation mode (MD or static/minimize).</span>
</span><span id="CHGNet-347"><a href="#CHGNet-347"><span class="linenos">347</span></a>
</span><span id="CHGNet-348"><a href="#CHGNet-348"><span class="linenos">348</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-349"><a href="#CHGNet-349"><span class="linenos">349</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-350"><a href="#CHGNet-350"><span class="linenos">350</span></a><span class="sd">        None</span>
</span><span id="CHGNet-351"><a href="#CHGNet-351"><span class="linenos">351</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-352"><a href="#CHGNet-352"><span class="linenos">352</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;structure.cif&#39;</span><span class="p">),</span> <span class="n">pyiron_to_ase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">))</span>
</span><span id="CHGNet-353"><a href="#CHGNet-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="CHGNet-354"><a href="#CHGNet-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="CHGNet-355"><a href="#CHGNet-355"><span class="linenos">355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_md</span><span class="p">()</span>
</span><span id="CHGNet-356"><a href="#CHGNet-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet-357"><a href="#CHGNet-357"><span class="linenos">357</span></a>            <span class="c1"># calc_mode = static is treated as minimize with only a single ioninc step</span>
</span><span id="CHGNet-358"><a href="#CHGNet-358"><span class="linenos">358</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_minimize</span><span class="p">()</span>
</span><span id="CHGNet-359"><a href="#CHGNet-359"><span class="linenos">359</span></a>
</span><span id="CHGNet-360"><a href="#CHGNet-360"><span class="linenos">360</span></a>
</span><span id="CHGNet-361"><a href="#CHGNet-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">_parse_calc_static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;error.out&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="CHGNet-362"><a href="#CHGNet-362"><span class="linenos">362</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-363"><a href="#CHGNet-363"><span class="linenos">363</span></a><span class="sd">        Parse the output of a static calculation.</span>
</span><span id="CHGNet-364"><a href="#CHGNet-364"><span class="linenos">364</span></a>
</span><span id="CHGNet-365"><a href="#CHGNet-365"><span class="linenos">365</span></a><span class="sd">        This function reads the static calculation output file and returns the </span>
</span><span id="CHGNet-366"><a href="#CHGNet-366"><span class="linenos">366</span></a><span class="sd">        corresponding DataFrame containing the optimization step and energy information.</span>
</span><span id="CHGNet-367"><a href="#CHGNet-367"><span class="linenos">367</span></a>
</span><span id="CHGNet-368"><a href="#CHGNet-368"><span class="linenos">368</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-369"><a href="#CHGNet-369"><span class="linenos">369</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-370"><a href="#CHGNet-370"><span class="linenos">370</span></a><span class="sd">        output : str, optional</span>
</span><span id="CHGNet-371"><a href="#CHGNet-371"><span class="linenos">371</span></a><span class="sd">            The name of the output file to parse, by default &#39;error.out&#39;.</span>
</span><span id="CHGNet-372"><a href="#CHGNet-372"><span class="linenos">372</span></a><span class="sd">        skip : int, optional</span>
</span><span id="CHGNet-373"><a href="#CHGNet-373"><span class="linenos">373</span></a><span class="sd">            The number of rows to skip at the start of the file, by default 3.</span>
</span><span id="CHGNet-374"><a href="#CHGNet-374"><span class="linenos">374</span></a>
</span><span id="CHGNet-375"><a href="#CHGNet-375"><span class="linenos">375</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-376"><a href="#CHGNet-376"><span class="linenos">376</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-377"><a href="#CHGNet-377"><span class="linenos">377</span></a><span class="sd">        pd.DataFrame or None</span>
</span><span id="CHGNet-378"><a href="#CHGNet-378"><span class="linenos">378</span></a><span class="sd">            A DataFrame containing the optimization results, or None if parsing fails.</span>
</span><span id="CHGNet-379"><a href="#CHGNet-379"><span class="linenos">379</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-380"><a href="#CHGNet-380"><span class="linenos">380</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="CHGNet-381"><a href="#CHGNet-381"><span class="linenos">381</span></a>            <span class="n">header</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="CHGNet-382"><a href="#CHGNet-382"><span class="linenos">382</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="CHGNet-383"><a href="#CHGNet-383"><span class="linenos">383</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="n">skip</span><span class="p">,</span> 
</span><span id="CHGNet-384"><a href="#CHGNet-384"><span class="linenos">384</span></a>                <span class="n">nrows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
</span><span id="CHGNet-385"><a href="#CHGNet-385"><span class="linenos">385</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span>
</span><span id="CHGNet-386"><a href="#CHGNet-386"><span class="linenos">386</span></a>            <span class="p">)</span>
</span><span id="CHGNet-387"><a href="#CHGNet-387"><span class="linenos">387</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="CHGNet-388"><a href="#CHGNet-388"><span class="linenos">388</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="CHGNet-389"><a href="#CHGNet-389"><span class="linenos">389</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="n">skip</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="CHGNet-390"><a href="#CHGNet-390"><span class="linenos">390</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span>
</span><span id="CHGNet-391"><a href="#CHGNet-391"><span class="linenos">391</span></a>                <span class="n">header</span><span class="o">=</span><span class="kc">None</span>
</span><span id="CHGNet-392"><a href="#CHGNet-392"><span class="linenos">392</span></a>            <span class="p">)</span>
</span><span id="CHGNet-393"><a href="#CHGNet-393"><span class="linenos">393</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;optimizer_class&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">columns</span><span class="p">[:])</span>
</span><span id="CHGNet-394"><a href="#CHGNet-394"><span class="linenos">394</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="CHGNet-395"><a href="#CHGNet-395"><span class="linenos">395</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet-396"><a href="#CHGNet-396"><span class="linenos">396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet-397"><a href="#CHGNet-397"><span class="linenos">397</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="CHGNet-398"><a href="#CHGNet-398"><span class="linenos">398</span></a>
</span><span id="CHGNet-399"><a href="#CHGNet-399"><span class="linenos">399</span></a>
</span><span id="CHGNet-400"><a href="#CHGNet-400"><span class="linenos">400</span></a>    <span class="k">def</span> <span class="nf">_parse_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;md_run.log&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="CHGNet-401"><a href="#CHGNet-401"><span class="linenos">401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-402"><a href="#CHGNet-402"><span class="linenos">402</span></a><span class="sd">        Parse the output of a molecular dynamics (MD) simulation.</span>
</span><span id="CHGNet-403"><a href="#CHGNet-403"><span class="linenos">403</span></a>
</span><span id="CHGNet-404"><a href="#CHGNet-404"><span class="linenos">404</span></a><span class="sd">        This function reads the MD log file and returns the corresponding DataFrame </span>
</span><span id="CHGNet-405"><a href="#CHGNet-405"><span class="linenos">405</span></a><span class="sd">        containing time, total energy, potential energy, kinetic energy, and temperature.</span>
</span><span id="CHGNet-406"><a href="#CHGNet-406"><span class="linenos">406</span></a>
</span><span id="CHGNet-407"><a href="#CHGNet-407"><span class="linenos">407</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-408"><a href="#CHGNet-408"><span class="linenos">408</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-409"><a href="#CHGNet-409"><span class="linenos">409</span></a><span class="sd">        output : str, optional</span>
</span><span id="CHGNet-410"><a href="#CHGNet-410"><span class="linenos">410</span></a><span class="sd">            The name of the MD log file to parse, by default &#39;md_run.log&#39;.</span>
</span><span id="CHGNet-411"><a href="#CHGNet-411"><span class="linenos">411</span></a>
</span><span id="CHGNet-412"><a href="#CHGNet-412"><span class="linenos">412</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-413"><a href="#CHGNet-413"><span class="linenos">413</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-414"><a href="#CHGNet-414"><span class="linenos">414</span></a><span class="sd">        pd.DataFrame or None</span>
</span><span id="CHGNet-415"><a href="#CHGNet-415"><span class="linenos">415</span></a><span class="sd">            A DataFrame containing the MD simulation results, or None if parsing fails.</span>
</span><span id="CHGNet-416"><a href="#CHGNet-416"><span class="linenos">416</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-417"><a href="#CHGNet-417"><span class="linenos">417</span></a>        <span class="k">try</span><span class="p">:</span>            
</span><span id="CHGNet-418"><a href="#CHGNet-418"><span class="linenos">418</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
</span><span id="CHGNet-419"><a href="#CHGNet-419"><span class="linenos">419</span></a>                <span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">output</span><span class="p">),</span> 
</span><span id="CHGNet-420"><a href="#CHGNet-420"><span class="linenos">420</span></a>                <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
</span><span id="CHGNet-421"><a href="#CHGNet-421"><span class="linenos">421</span></a>                <span class="n">sep</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span>
</span><span id="CHGNet-422"><a href="#CHGNet-422"><span class="linenos">422</span></a>            <span class="p">)</span>
</span><span id="CHGNet-423"><a href="#CHGNet-423"><span class="linenos">423</span></a>            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="s1">&#39;Etot&#39;</span><span class="p">,</span> <span class="s1">&#39;Epot&#39;</span><span class="p">,</span> <span class="s1">&#39;Ekin&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>
</span><span id="CHGNet-424"><a href="#CHGNet-424"><span class="linenos">424</span></a>            <span class="k">return</span> <span class="n">df</span>
</span><span id="CHGNet-425"><a href="#CHGNet-425"><span class="linenos">425</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet-426"><a href="#CHGNet-426"><span class="linenos">426</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet-427"><a href="#CHGNet-427"><span class="linenos">427</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="CHGNet-428"><a href="#CHGNet-428"><span class="linenos">428</span></a>
</span><span id="CHGNet-429"><a href="#CHGNet-429"><span class="linenos">429</span></a>
</span><span id="CHGNet-430"><a href="#CHGNet-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">collect_output</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet-431"><a href="#CHGNet-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-432"><a href="#CHGNet-432"><span class="linenos">432</span></a><span class="sd">        Collect and store the results of the calculation.</span>
</span><span id="CHGNet-433"><a href="#CHGNet-433"><span class="linenos">433</span></a>
</span><span id="CHGNet-434"><a href="#CHGNet-434"><span class="linenos">434</span></a><span class="sd">        This function parses the final structure, trajectory, and other output properties,</span>
</span><span id="CHGNet-435"><a href="#CHGNet-435"><span class="linenos">435</span></a><span class="sd">        and stores them in the HDF5 format. The structure is updated, and various properties </span>
</span><span id="CHGNet-436"><a href="#CHGNet-436"><span class="linenos">436</span></a><span class="sd">        such as energies, forces, and magnetization are saved to the output group.</span>
</span><span id="CHGNet-437"><a href="#CHGNet-437"><span class="linenos">437</span></a>
</span><span id="CHGNet-438"><a href="#CHGNet-438"><span class="linenos">438</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-439"><a href="#CHGNet-439"><span class="linenos">439</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-440"><a href="#CHGNet-440"><span class="linenos">440</span></a><span class="sd">        None</span>
</span><span id="CHGNet-441"><a href="#CHGNet-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-442"><a href="#CHGNet-442"><span class="linenos">442</span></a>                    
</span><span id="CHGNet-443"><a href="#CHGNet-443"><span class="linenos">443</span></a>        <span class="n">relaxed_ase_structure</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;final_structure.cif&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;cif&#39;</span><span class="p">)</span>
</span><span id="CHGNet-444"><a href="#CHGNet-444"><span class="linenos">444</span></a>        <span class="n">relaxed_pyiron_structure</span> <span class="o">=</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">relaxed_ase_structure</span><span class="p">)</span>
</span><span id="CHGNet-445"><a href="#CHGNet-445"><span class="linenos">445</span></a>
</span><span id="CHGNet-446"><a href="#CHGNet-446"><span class="linenos">446</span></a>        <span class="c1"># Store the relaxed structure in the HDF5 group</span>
</span><span id="CHGNet-447"><a href="#CHGNet-447"><span class="linenos">447</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-448"><a href="#CHGNet-448"><span class="linenos">448</span></a>            <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>
</span><span id="CHGNet-449"><a href="#CHGNet-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>  <span class="c1"># Update the job&#39;s structure</span>
</span><span id="CHGNet-450"><a href="#CHGNet-450"><span class="linenos">450</span></a>
</span><span id="CHGNet-451"><a href="#CHGNet-451"><span class="linenos">451</span></a>        <span class="c1"># Parse trajectory        </span>
</span><span id="CHGNet-452"><a href="#CHGNet-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>
</span><span id="CHGNet-453"><a href="#CHGNet-453"><span class="linenos">453</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span>
</span><span id="CHGNet-454"><a href="#CHGNet-454"><span class="linenos">454</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CHGNet-455"><a href="#CHGNet-455"><span class="linenos">455</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="CHGNet-456"><a href="#CHGNet-456"><span class="linenos">456</span></a>                    <span class="n">traj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>                   
</span><span id="CHGNet-457"><a href="#CHGNet-457"><span class="linenos">457</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-458"><a href="#CHGNet-458"><span class="linenos">458</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CHGNet-459"><a href="#CHGNet-459"><span class="linenos">459</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;atom_positions&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CHGNet-460"><a href="#CHGNet-460"><span class="linenos">460</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet-461"><a href="#CHGNet-461"><span class="linenos">461</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet-462"><a href="#CHGNet-462"><span class="linenos">462</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/dft&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-463"><a href="#CHGNet-463"><span class="linenos">463</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;magnetization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;magmoms&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet-464"><a href="#CHGNet-464"><span class="linenos">464</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet-465"><a href="#CHGNet-465"><span class="linenos">465</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet-466"><a href="#CHGNet-466"><span class="linenos">466</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>            
</span><span id="CHGNet-467"><a href="#CHGNet-467"><span class="linenos">467</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>
</span><span id="CHGNet-468"><a href="#CHGNet-468"><span class="linenos">468</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CHGNet-469"><a href="#CHGNet-469"><span class="linenos">469</span></a>                <span class="n">traj</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="CHGNet-470"><a href="#CHGNet-470"><span class="linenos">470</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-471"><a href="#CHGNet-471"><span class="linenos">471</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet-472"><a href="#CHGNet-472"><span class="linenos">472</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet-473"><a href="#CHGNet-473"><span class="linenos">473</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_stress</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet-474"><a href="#CHGNet-474"><span class="linenos">474</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_forces</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet-475"><a href="#CHGNet-475"><span class="linenos">475</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet-476"><a href="#CHGNet-476"><span class="linenos">476</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet-477"><a href="#CHGNet-477"><span class="linenos">477</span></a>
</span><span id="CHGNet-478"><a href="#CHGNet-478"><span class="linenos">478</span></a>        <span class="c1"># Parse other properties</span>
</span><span id="CHGNet-479"><a href="#CHGNet-479"><span class="linenos">479</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>            
</span><span id="CHGNet-480"><a href="#CHGNet-480"><span class="linenos">480</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_static</span><span class="p">()</span>
</span><span id="CHGNet-481"><a href="#CHGNet-481"><span class="linenos">481</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-482"><a href="#CHGNet-482"><span class="linenos">482</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-483"><a href="#CHGNet-483"><span class="linenos">483</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-484"><a href="#CHGNet-484"><span class="linenos">484</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-485"><a href="#CHGNet-485"><span class="linenos">485</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Step&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-486"><a href="#CHGNet-486"><span class="linenos">486</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="CHGNet-487"><a href="#CHGNet-487"><span class="linenos">487</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">])</span>
</span><span id="CHGNet-488"><a href="#CHGNet-488"><span class="linenos">488</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-489"><a href="#CHGNet-489"><span class="linenos">489</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Epot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-490"><a href="#CHGNet-490"><span class="linenos">490</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Etot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>                
</span><span id="CHGNet-491"><a href="#CHGNet-491"><span class="linenos">491</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_kin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ekin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-492"><a href="#CHGNet-492"><span class="linenos">492</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-493"><a href="#CHGNet-493"><span class="linenos">493</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-494"><a href="#CHGNet-494"><span class="linenos">494</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet-495"><a href="#CHGNet-495"><span class="linenos">495</span></a>
</span><span id="CHGNet-496"><a href="#CHGNet-496"><span class="linenos">496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">finished</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CHGNet-497"><a href="#CHGNet-497"><span class="linenos">497</span></a>
</span><span id="CHGNet-498"><a href="#CHGNet-498"><span class="linenos">498</span></a>
</span><span id="CHGNet-499"><a href="#CHGNet-499"><span class="linenos">499</span></a>    <span class="k">def</span> <span class="nf">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atoms</span><span class="p">:</span>
</span><span id="CHGNet-500"><a href="#CHGNet-500"><span class="linenos">500</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet-501"><a href="#CHGNet-501"><span class="linenos">501</span></a><span class="sd">        Retrieve the structure at a given frame from the calculation output.</span>
</span><span id="CHGNet-502"><a href="#CHGNet-502"><span class="linenos">502</span></a>
</span><span id="CHGNet-503"><a href="#CHGNet-503"><span class="linenos">503</span></a><span class="sd">        This function returns the atomic structure (positions, cell, species) at the </span>
</span><span id="CHGNet-504"><a href="#CHGNet-504"><span class="linenos">504</span></a><span class="sd">        specified frame index. The frame index is adjusted to ensure it is valid.</span>
</span><span id="CHGNet-505"><a href="#CHGNet-505"><span class="linenos">505</span></a>
</span><span id="CHGNet-506"><a href="#CHGNet-506"><span class="linenos">506</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet-507"><a href="#CHGNet-507"><span class="linenos">507</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet-508"><a href="#CHGNet-508"><span class="linenos">508</span></a><span class="sd">        frame : int, optional</span>
</span><span id="CHGNet-509"><a href="#CHGNet-509"><span class="linenos">509</span></a><span class="sd">            The frame index to retrieve. If negative, it is counted from the last frame, </span>
</span><span id="CHGNet-510"><a href="#CHGNet-510"><span class="linenos">510</span></a><span class="sd">            by default -1.</span>
</span><span id="CHGNet-511"><a href="#CHGNet-511"><span class="linenos">511</span></a>
</span><span id="CHGNet-512"><a href="#CHGNet-512"><span class="linenos">512</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet-513"><a href="#CHGNet-513"><span class="linenos">513</span></a><span class="sd">        -------</span>
</span><span id="CHGNet-514"><a href="#CHGNet-514"><span class="linenos">514</span></a><span class="sd">        Atoms</span>
</span><span id="CHGNet-515"><a href="#CHGNet-515"><span class="linenos">515</span></a><span class="sd">            The ASE Atoms object representing the structure at the given frame.</span>
</span><span id="CHGNet-516"><a href="#CHGNet-516"><span class="linenos">516</span></a>
</span><span id="CHGNet-517"><a href="#CHGNet-517"><span class="linenos">517</span></a><span class="sd">        Raises</span>
</span><span id="CHGNet-518"><a href="#CHGNet-518"><span class="linenos">518</span></a><span class="sd">        ------</span>
</span><span id="CHGNet-519"><a href="#CHGNet-519"><span class="linenos">519</span></a><span class="sd">        ValueError</span>
</span><span id="CHGNet-520"><a href="#CHGNet-520"><span class="linenos">520</span></a><span class="sd">            If no structures are found in the job output.</span>
</span><span id="CHGNet-521"><a href="#CHGNet-521"><span class="linenos">521</span></a><span class="sd">        IndexError</span>
</span><span id="CHGNet-522"><a href="#CHGNet-522"><span class="linenos">522</span></a><span class="sd">            If the frame index is out of range.</span>
</span><span id="CHGNet-523"><a href="#CHGNet-523"><span class="linenos">523</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet-524"><a href="#CHGNet-524"><span class="linenos">524</span></a>        <span class="n">num_structures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_structures</span>
</span><span id="CHGNet-525"><a href="#CHGNet-525"><span class="linenos">525</span></a>        <span class="k">if</span> <span class="n">num_structures</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CHGNet-526"><a href="#CHGNet-526"><span class="linenos">526</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No structures found in the job output.&quot;</span><span class="p">)</span>
</span><span id="CHGNet-527"><a href="#CHGNet-527"><span class="linenos">527</span></a>
</span><span id="CHGNet-528"><a href="#CHGNet-528"><span class="linenos">528</span></a>        <span class="c1"># Ensure frame is valid</span>
</span><span id="CHGNet-529"><a href="#CHGNet-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CHGNet-530"><a href="#CHGNet-530"><span class="linenos">530</span></a>            <span class="n">frame</span> <span class="o">+=</span> <span class="n">num_structures</span>
</span><span id="CHGNet-531"><a href="#CHGNet-531"><span class="linenos">531</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&gt;=</span> <span class="n">num_structures</span><span class="p">:</span>
</span><span id="CHGNet-532"><a href="#CHGNet-532"><span class="linenos">532</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="CHGNet-533"><a href="#CHGNet-533"><span class="linenos">533</span></a>                <span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">frame</span><span class="si">}</span><span class="s2"> is out of range for </span><span class="si">{</span><span class="n">num_structures</span><span class="si">}</span><span class="s2"> structures.&quot;</span><span class="p">)</span>
</span><span id="CHGNet-534"><a href="#CHGNet-534"><span class="linenos">534</span></a>
</span><span id="CHGNet-535"><a href="#CHGNet-535"><span class="linenos">535</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-536"><a href="#CHGNet-536"><span class="linenos">536</span></a>            <span class="n">positions</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>
</span><span id="CHGNet-537"><a href="#CHGNet-537"><span class="linenos">537</span></a>            <span class="n">cell</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>            
</span><span id="CHGNet-538"><a href="#CHGNet-538"><span class="linenos">538</span></a>        <span class="c1"># Read positions and cell</span>
</span><span id="CHGNet-539"><a href="#CHGNet-539"><span class="linenos">539</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/structure&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet-540"><a href="#CHGNet-540"><span class="linenos">540</span></a>            <span class="n">species</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span>
</span><span id="CHGNet-541"><a href="#CHGNet-541"><span class="linenos">541</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">]</span>
</span><span id="CHGNet-542"><a href="#CHGNet-542"><span class="linenos">542</span></a>
</span><span id="CHGNet-543"><a href="#CHGNet-543"><span class="linenos">543</span></a>        <span class="c1"># Generate symbols list</span>
</span><span id="CHGNet-544"><a href="#CHGNet-544"><span class="linenos">544</span></a>        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">species</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="CHGNet-545"><a href="#CHGNet-545"><span class="linenos">545</span></a>        <span class="k">return</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">Atoms</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Custom job class for using CHGNet within the pyiron framework.</p>

<p>This class provides methods to perform static calculations, structure relaxation,
and molecular dynamics simulations using CHGNet.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>structure</strong> (pyiron.atomistics.structure.atoms.Atoms):
Structure associated with the job.</li>
<li><strong>input</strong> (CalcParams):
Input parameters for the CHGNet calculations.</li>
</ul>
</div>


                            <div id="CHGNet.__init__" class="classattr">
                                        <input id="CHGNet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CHGNet</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">project</span>, </span><span class="param"><span class="n">job_name</span></span>)</span>

                <label class="view-source-button" for="CHGNet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.__init__-39"><a href="#CHGNet.__init__-39"><span class="linenos">39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
</span><span id="CHGNet.__init__-40"><a href="#CHGNet.__init__-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.__init__-41"><a href="#CHGNet.__init__-41"><span class="linenos">41</span></a><span class="sd">        Initialize the CHGNet job.</span>
</span><span id="CHGNet.__init__-42"><a href="#CHGNet.__init__-42"><span class="linenos">42</span></a>
</span><span id="CHGNet.__init__-43"><a href="#CHGNet.__init__-43"><span class="linenos">43</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet.__init__-44"><a href="#CHGNet.__init__-44"><span class="linenos">44</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet.__init__-45"><a href="#CHGNet.__init__-45"><span class="linenos">45</span></a><span class="sd">        project : pyiron.Project</span>
</span><span id="CHGNet.__init__-46"><a href="#CHGNet.__init__-46"><span class="linenos">46</span></a><span class="sd">            The pyiron project in which the job resides.</span>
</span><span id="CHGNet.__init__-47"><a href="#CHGNet.__init__-47"><span class="linenos">47</span></a><span class="sd">        job_name : str</span>
</span><span id="CHGNet.__init__-48"><a href="#CHGNet.__init__-48"><span class="linenos">48</span></a><span class="sd">            Name of the job.</span>
</span><span id="CHGNet.__init__-49"><a href="#CHGNet.__init__-49"><span class="linenos">49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.__init__-50"><a href="#CHGNet.__init__-50"><span class="linenos">50</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CHGNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">,</span> <span class="n">job_name</span><span class="p">)</span>
</span><span id="CHGNet.__init__-51"><a href="#CHGNet.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CHGNet.__init__-52"><a href="#CHGNet.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="n">CalcParams</span><span class="p">()</span>
</span><span id="CHGNet.__init__-53"><a href="#CHGNet.__init__-53"><span class="linenos">53</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">file_exists</span><span class="p">:</span>
</span><span id="CHGNet.__init__-54"><a href="#CHGNet.__init__-54"><span class="linenos">54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">from_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="CHGNet.__init__-55"><a href="#CHGNet.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_executable_activate</span><span class="p">(</span><span class="n">codename</span><span class="o">=</span><span class="s1">&#39;chgnet&#39;</span><span class="p">)</span>            
</span></pre></div>


            <div class="docstring"><p>Initialize the CHGNet job.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>project</strong> (pyiron.Project):
The pyiron project in which the job resides.</li>
<li><strong>job_name</strong> (str):
Name of the job.</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.structure" class="classattr">
                                        <input id="CHGNet.structure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">structure</span>

                <label class="view-source-button" for="CHGNet.structure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.structure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.structure-147"><a href="#CHGNet.structure-147"><span class="linenos">147</span></a>    <span class="nd">@property</span>
</span><span id="CHGNet.structure-148"><a href="#CHGNet.structure-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">structure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CHGNet.structure-149"><a href="#CHGNet.structure-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.structure-150"><a href="#CHGNet.structure-150"><span class="linenos">150</span></a>
</span><span id="CHGNet.structure-151"><a href="#CHGNet.structure-151"><span class="linenos">151</span></a><span class="sd">        Returns:</span>
</span><span id="CHGNet.structure-152"><a href="#CHGNet.structure-152"><span class="linenos">152</span></a>
</span><span id="CHGNet.structure-153"><a href="#CHGNet.structure-153"><span class="linenos">153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.structure-154"><a href="#CHGNet.structure-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_structure</span>
</span></pre></div>


            <div class="docstring"><p>Returns:</p>
</div>


                            </div>
                            <div id="CHGNet.input" class="classattr">
                                <div class="attr variable">
            <span class="name">input</span>

        
    </div>
    <a class="headerlink" href="#CHGNet.input"></a>
    
    

                            </div>
                            <div id="CHGNet.fmax" class="classattr">
                                        <input id="CHGNet.fmax-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">fmax</span><span class="annotation">: float</span>

                <label class="view-source-button" for="CHGNet.fmax-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.fmax"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.fmax-57"><a href="#CHGNet.fmax-57"><span class="linenos">57</span></a>    <span class="nd">@property</span>
</span><span id="CHGNet.fmax-58"><a href="#CHGNet.fmax-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">fmax</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="CHGNet.fmax-59"><a href="#CHGNet.fmax-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.fmax-60"><a href="#CHGNet.fmax-60"><span class="linenos">60</span></a><span class="sd">        Get the maximum force tolerance for ionic relaxation.</span>
</span><span id="CHGNet.fmax-61"><a href="#CHGNet.fmax-61"><span class="linenos">61</span></a>
</span><span id="CHGNet.fmax-62"><a href="#CHGNet.fmax-62"><span class="linenos">62</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet.fmax-63"><a href="#CHGNet.fmax-63"><span class="linenos">63</span></a><span class="sd">        -------</span>
</span><span id="CHGNet.fmax-64"><a href="#CHGNet.fmax-64"><span class="linenos">64</span></a><span class="sd">        float</span>
</span><span id="CHGNet.fmax-65"><a href="#CHGNet.fmax-65"><span class="linenos">65</span></a><span class="sd">            Maximum force tolerance (eV/Å).</span>
</span><span id="CHGNet.fmax-66"><a href="#CHGNet.fmax-66"><span class="linenos">66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.fmax-67"><a href="#CHGNet.fmax-67"><span class="linenos">67</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the maximum force tolerance for ionic relaxation.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float</strong>: Maximum force tolerance (eV/Å).</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.max_iter" class="classattr">
                                        <input id="CHGNet.max_iter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">max_iter</span><span class="annotation">: int</span>

                <label class="view-source-button" for="CHGNet.max_iter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.max_iter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.max_iter-81"><a href="#CHGNet.max_iter-81"><span class="linenos">81</span></a>    <span class="nd">@property</span>
</span><span id="CHGNet.max_iter-82"><a href="#CHGNet.max_iter-82"><span class="linenos">82</span></a>    <span class="k">def</span> <span class="nf">max_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="CHGNet.max_iter-83"><a href="#CHGNet.max_iter-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.max_iter-84"><a href="#CHGNet.max_iter-84"><span class="linenos">84</span></a><span class="sd">        Get the maximum number of iterations for relaxation.</span>
</span><span id="CHGNet.max_iter-85"><a href="#CHGNet.max_iter-85"><span class="linenos">85</span></a>
</span><span id="CHGNet.max_iter-86"><a href="#CHGNet.max_iter-86"><span class="linenos">86</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet.max_iter-87"><a href="#CHGNet.max_iter-87"><span class="linenos">87</span></a><span class="sd">        -------</span>
</span><span id="CHGNet.max_iter-88"><a href="#CHGNet.max_iter-88"><span class="linenos">88</span></a><span class="sd">        int</span>
</span><span id="CHGNet.max_iter-89"><a href="#CHGNet.max_iter-89"><span class="linenos">89</span></a><span class="sd">            Maximum number of iterations.</span>
</span><span id="CHGNet.max_iter-90"><a href="#CHGNet.max_iter-90"><span class="linenos">90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.max_iter-91"><a href="#CHGNet.max_iter-91"><span class="linenos">91</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the maximum number of iterations for relaxation.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>int</strong>: Maximum number of iterations.</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.calc_static" class="classattr">
                                        <input id="CHGNet.calc_static-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_static</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CHGNet.calc_static-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.calc_static"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.calc_static-106"><a href="#CHGNet.calc_static-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="nf">calc_static</span><span class="p">(</span>
</span><span id="CHGNet.calc_static-107"><a href="#CHGNet.calc_static-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet.calc_static-108"><a href="#CHGNet.calc_static-108"><span class="linenos">108</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet.calc_static-109"><a href="#CHGNet.calc_static-109"><span class="linenos">109</span></a>    <span class="p">):</span>        
</span><span id="CHGNet.calc_static-110"><a href="#CHGNet.calc_static-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_static-111"><a href="#CHGNet.calc_static-111"><span class="linenos">111</span></a><span class="sd">        Perform a static calculation.</span>
</span><span id="CHGNet.calc_static-112"><a href="#CHGNet.calc_static-112"><span class="linenos">112</span></a>
</span><span id="CHGNet.calc_static-113"><a href="#CHGNet.calc_static-113"><span class="linenos">113</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet.calc_static-114"><a href="#CHGNet.calc_static-114"><span class="linenos">114</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet.calc_static-115"><a href="#CHGNet.calc_static-115"><span class="linenos">115</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet.calc_static-116"><a href="#CHGNet.calc_static-116"><span class="linenos">116</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet.calc_static-117"><a href="#CHGNet.calc_static-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_static-118"><a href="#CHGNet.calc_static-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">relax_cell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_isolated_atoms</span><span class="o">=</span><span class="n">on_isolated_atoms</span><span class="p">)</span>
</span><span id="CHGNet.calc_static-119"><a href="#CHGNet.calc_static-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s2">&quot;calc_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;static&quot;</span>   
</span></pre></div>


            <div class="docstring"><p>Perform a static calculation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>on_isolated_atoms</strong> ({'ignore', 'warn', 'error'}, optional):
Behavior for isolated atoms (default is 'warn').</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.calc_minimize" class="classattr">
                                        <input id="CHGNet.calc_minimize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_minimize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ionic_force_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>,</span><span class="param">	<span class="n">n_print</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">relax_cell</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s1">&#39;relax.traj&#39;</span>,</span><span class="param">	<span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CHGNet.calc_minimize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.calc_minimize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.calc_minimize-121"><a href="#CHGNet.calc_minimize-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">calc_minimize</span><span class="p">(</span>
</span><span id="CHGNet.calc_minimize-122"><a href="#CHGNet.calc_minimize-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-123"><a href="#CHGNet.calc_minimize-123"><span class="linenos">123</span></a>        <span class="n">ionic_force_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-124"><a href="#CHGNet.calc_minimize-124"><span class="linenos">124</span></a>        <span class="n">max_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-125"><a href="#CHGNet.calc_minimize-125"><span class="linenos">125</span></a>        <span class="n">n_print</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-126"><a href="#CHGNet.calc_minimize-126"><span class="linenos">126</span></a>        <span class="n">relax_cell</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-127"><a href="#CHGNet.calc_minimize-127"><span class="linenos">127</span></a>        <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s1">&#39;relax.traj&#39;</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-128"><a href="#CHGNet.calc_minimize-128"><span class="linenos">128</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-129"><a href="#CHGNet.calc_minimize-129"><span class="linenos">129</span></a>    <span class="p">):</span>
</span><span id="CHGNet.calc_minimize-130"><a href="#CHGNet.calc_minimize-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_minimize-131"><a href="#CHGNet.calc_minimize-131"><span class="linenos">131</span></a><span class="sd">        Perform a structure relaxation (geometry optimization). More CHGNet parameters can be specified by </span>
</span><span id="CHGNet.calc_minimize-132"><a href="#CHGNet.calc_minimize-132"><span class="linenos">132</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="CHGNet.calc_minimize-133"><a href="#CHGNet.calc_minimize-133"><span class="linenos">133</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-structoptimizer](https://chgnet.lbl.gov/api#class-structoptimizer).</span>
</span><span id="CHGNet.calc_minimize-134"><a href="#CHGNet.calc_minimize-134"><span class="linenos">134</span></a>
</span><span id="CHGNet.calc_minimize-135"><a href="#CHGNet.calc_minimize-135"><span class="linenos">135</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet.calc_minimize-136"><a href="#CHGNet.calc_minimize-136"><span class="linenos">136</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet.calc_minimize-137"><a href="#CHGNet.calc_minimize-137"><span class="linenos">137</span></a><span class="sd">        ionic_force_tolerance : float, optional</span>
</span><span id="CHGNet.calc_minimize-138"><a href="#CHGNet.calc_minimize-138"><span class="linenos">138</span></a><span class="sd">            Convergence criterion for forces (default is 0.1 eV/Å).</span>
</span><span id="CHGNet.calc_minimize-139"><a href="#CHGNet.calc_minimize-139"><span class="linenos">139</span></a><span class="sd">        max_iter : int, optional</span>
</span><span id="CHGNet.calc_minimize-140"><a href="#CHGNet.calc_minimize-140"><span class="linenos">140</span></a><span class="sd">            Maximum number of iterations (default is 500).</span>
</span><span id="CHGNet.calc_minimize-141"><a href="#CHGNet.calc_minimize-141"><span class="linenos">141</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="CHGNet.calc_minimize-142"><a href="#CHGNet.calc_minimize-142"><span class="linenos">142</span></a><span class="sd">            Frequency of logging output (default is 1).</span>
</span><span id="CHGNet.calc_minimize-143"><a href="#CHGNet.calc_minimize-143"><span class="linenos">143</span></a><span class="sd">        relax_cell : bool or None, optional</span>
</span><span id="CHGNet.calc_minimize-144"><a href="#CHGNet.calc_minimize-144"><span class="linenos">144</span></a><span class="sd">            Whether to allow relaxation of the simulation cell (default is True).</span>
</span><span id="CHGNet.calc_minimize-145"><a href="#CHGNet.calc_minimize-145"><span class="linenos">145</span></a><span class="sd">        save_path : str or None, optional</span>
</span><span id="CHGNet.calc_minimize-146"><a href="#CHGNet.calc_minimize-146"><span class="linenos">146</span></a><span class="sd">            Path to save the trajectory file (default is &#39;relax.traj&#39;).</span>
</span><span id="CHGNet.calc_minimize-147"><a href="#CHGNet.calc_minimize-147"><span class="linenos">147</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet.calc_minimize-148"><a href="#CHGNet.calc_minimize-148"><span class="linenos">148</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet.calc_minimize-149"><a href="#CHGNet.calc_minimize-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_minimize-150"><a href="#CHGNet.calc_minimize-150"><span class="linenos">150</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span>
</span><span id="CHGNet.calc_minimize-151"><a href="#CHGNet.calc_minimize-151"><span class="linenos">151</span></a>            <span class="n">ionic_energy_tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-152"><a href="#CHGNet.calc_minimize-152"><span class="linenos">152</span></a>            <span class="n">ionic_force_tolerance</span><span class="o">=</span><span class="n">ionic_force_tolerance</span><span class="p">,</span>
</span><span id="CHGNet.calc_minimize-153"><a href="#CHGNet.calc_minimize-153"><span class="linenos">153</span></a>            <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>            
</span><span id="CHGNet.calc_minimize-154"><a href="#CHGNet.calc_minimize-154"><span class="linenos">154</span></a>        <span class="p">)</span>       
</span><span id="CHGNet.calc_minimize-155"><a href="#CHGNet.calc_minimize-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;relax_cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relax_cell</span>
</span><span id="CHGNet.calc_minimize-156"><a href="#CHGNet.calc_minimize-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save_path</span>
</span><span id="CHGNet.calc_minimize-157"><a href="#CHGNet.calc_minimize-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="CHGNet.calc_minimize-158"><a href="#CHGNet.calc_minimize-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;assign_magmoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>                          
</span><span id="CHGNet.calc_minimize-159"><a href="#CHGNet.calc_minimize-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span> 
</span><span id="CHGNet.calc_minimize-160"><a href="#CHGNet.calc_minimize-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;n_print&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_print</span>
</span><span id="CHGNet.calc_minimize-161"><a href="#CHGNet.calc_minimize-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;ionic_force_tolerance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ionic_force_tolerance</span>        
</span></pre></div>


            <div class="docstring"><p>Perform a structure relaxation (geometry optimization). More CHGNet parameters can be specified by 
explicitly adding them to <code>job.input</code> dictionary, see
<a href="https://chgnet.lbl.gov/api#class-structoptimizer">https://chgnet.lbl.gov/api#class-structoptimizer</a>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ionic_force_tolerance</strong> (float, optional):
Convergence criterion for forces (default is 0.1 eV/Å).</li>
<li><strong>max_iter</strong> (int, optional):
Maximum number of iterations (default is 500).</li>
<li><strong>n_print</strong> (int, optional):
Frequency of logging output (default is 1).</li>
<li><strong>relax_cell</strong> (bool or None, optional):
Whether to allow relaxation of the simulation cell (default is True).</li>
<li><strong>save_path</strong> (str or None, optional):
Path to save the trajectory file (default is 'relax.traj').</li>
<li><strong>on_isolated_atoms</strong> ({'ignore', 'warn', 'error'}, optional):
Behavior for isolated atoms (default is 'warn').</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.calc_md" class="classattr">
                                        <input id="CHGNet.calc_md-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_md</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mi">300</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">n_ionic_steps</span><span class="o">=</span><span class="mi">100</span>,</span><span class="param">	<span class="n">time_step</span><span class="o">=</span><span class="mf">2.0</span>,</span><span class="param">	<span class="n">n_print</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="mf">100.0</span>,</span><span class="param">	<span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">trajectory</span><span class="o">=</span><span class="s1">&#39;md_run.traj&#39;</span>,</span><span class="param">	<span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;md_run.log&#39;</span>,</span><span class="param">	<span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span>,</span><span class="param">	<span class="n">starting_temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ensemble</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;nvt&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CHGNet.calc_md-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.calc_md"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.calc_md-226"><a href="#CHGNet.calc_md-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">calc_md</span><span class="p">(</span>
</span><span id="CHGNet.calc_md-227"><a href="#CHGNet.calc_md-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-228"><a href="#CHGNet.calc_md-228"><span class="linenos">228</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-229"><a href="#CHGNet.calc_md-229"><span class="linenos">229</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-230"><a href="#CHGNet.calc_md-230"><span class="linenos">230</span></a>        <span class="n">n_ionic_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-231"><a href="#CHGNet.calc_md-231"><span class="linenos">231</span></a>        <span class="n">time_step</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># in femto-seconds</span>
</span><span id="CHGNet.calc_md-232"><a href="#CHGNet.calc_md-232"><span class="linenos">232</span></a>        <span class="n">n_print</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-233"><a href="#CHGNet.calc_md-233"><span class="linenos">233</span></a>        <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="c1"># taut: float | None = None,        </span>
</span><span id="CHGNet.calc_md-234"><a href="#CHGNet.calc_md-234"><span class="linenos">234</span></a>        <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># taup: float | None = None,        </span>
</span><span id="CHGNet.calc_md-235"><a href="#CHGNet.calc_md-235"><span class="linenos">235</span></a>        <span class="n">trajectory</span><span class="o">=</span><span class="s2">&quot;md_run.traj&quot;</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-236"><a href="#CHGNet.calc_md-236"><span class="linenos">236</span></a>        <span class="n">logfile</span><span class="o">=</span><span class="s2">&quot;md_run.log&quot;</span><span class="p">,</span>        
</span><span id="CHGNet.calc_md-237"><a href="#CHGNet.calc_md-237"><span class="linenos">237</span></a>        <span class="n">on_isolated_atoms</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-238"><a href="#CHGNet.calc_md-238"><span class="linenos">238</span></a>        <span class="n">starting_temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-239"><a href="#CHGNet.calc_md-239"><span class="linenos">239</span></a>        <span class="n">ensemble</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nvt&quot;</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-240"><a href="#CHGNet.calc_md-240"><span class="linenos">240</span></a>    <span class="p">):</span>        
</span><span id="CHGNet.calc_md-241"><a href="#CHGNet.calc_md-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_md-242"><a href="#CHGNet.calc_md-242"><span class="linenos">242</span></a><span class="sd">        Set up and perform a molecular dynamics (MD) simulation. More CHGNet parameters can be specified by </span>
</span><span id="CHGNet.calc_md-243"><a href="#CHGNet.calc_md-243"><span class="linenos">243</span></a><span class="sd">        explicitly adding them to `job.input` dictionary, see</span>
</span><span id="CHGNet.calc_md-244"><a href="#CHGNet.calc_md-244"><span class="linenos">244</span></a><span class="sd">        [https://chgnet.lbl.gov/api#class-moleculardynamics](https://chgnet.lbl.gov/api#class-moleculardynamics).</span>
</span><span id="CHGNet.calc_md-245"><a href="#CHGNet.calc_md-245"><span class="linenos">245</span></a>
</span><span id="CHGNet.calc_md-246"><a href="#CHGNet.calc_md-246"><span class="linenos">246</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet.calc_md-247"><a href="#CHGNet.calc_md-247"><span class="linenos">247</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet.calc_md-248"><a href="#CHGNet.calc_md-248"><span class="linenos">248</span></a><span class="sd">        temperature : float, optional</span>
</span><span id="CHGNet.calc_md-249"><a href="#CHGNet.calc_md-249"><span class="linenos">249</span></a><span class="sd">            Target temperature of the simulation in Kelvin (default is 300 K).</span>
</span><span id="CHGNet.calc_md-250"><a href="#CHGNet.calc_md-250"><span class="linenos">250</span></a><span class="sd">        pressure : float or None, optional</span>
</span><span id="CHGNet.calc_md-251"><a href="#CHGNet.calc_md-251"><span class="linenos">251</span></a><span class="sd">            Target pressure for the simulation in bar (default is None).</span>
</span><span id="CHGNet.calc_md-252"><a href="#CHGNet.calc_md-252"><span class="linenos">252</span></a><span class="sd">        n_ionic_steps : int, optional</span>
</span><span id="CHGNet.calc_md-253"><a href="#CHGNet.calc_md-253"><span class="linenos">253</span></a><span class="sd">            Number of ionic steps to simulate (default is 100).</span>
</span><span id="CHGNet.calc_md-254"><a href="#CHGNet.calc_md-254"><span class="linenos">254</span></a><span class="sd">        time_step : float, optional</span>
</span><span id="CHGNet.calc_md-255"><a href="#CHGNet.calc_md-255"><span class="linenos">255</span></a><span class="sd">            Time step for the simulation in femtoseconds (default is 2.0 fs).</span>
</span><span id="CHGNet.calc_md-256"><a href="#CHGNet.calc_md-256"><span class="linenos">256</span></a><span class="sd">        n_print : int, optional</span>
</span><span id="CHGNet.calc_md-257"><a href="#CHGNet.calc_md-257"><span class="linenos">257</span></a><span class="sd">            Frequency of printing simulation logs (default is 10).</span>
</span><span id="CHGNet.calc_md-258"><a href="#CHGNet.calc_md-258"><span class="linenos">258</span></a><span class="sd">        temperature_damping_timescale : float, optional</span>
</span><span id="CHGNet.calc_md-259"><a href="#CHGNet.calc_md-259"><span class="linenos">259</span></a><span class="sd">            Timescale for temperature damping in femtoseconds (default is 100.0 fs).</span>
</span><span id="CHGNet.calc_md-260"><a href="#CHGNet.calc_md-260"><span class="linenos">260</span></a><span class="sd">        pressure_damping_timescale : float or None, optional</span>
</span><span id="CHGNet.calc_md-261"><a href="#CHGNet.calc_md-261"><span class="linenos">261</span></a><span class="sd">            Timescale for pressure damping in femtoseconds (default is None).</span>
</span><span id="CHGNet.calc_md-262"><a href="#CHGNet.calc_md-262"><span class="linenos">262</span></a><span class="sd">        trajectory : str, optional</span>
</span><span id="CHGNet.calc_md-263"><a href="#CHGNet.calc_md-263"><span class="linenos">263</span></a><span class="sd">            Name of the output trajectory file (default is &#39;md_run.traj&#39;).</span>
</span><span id="CHGNet.calc_md-264"><a href="#CHGNet.calc_md-264"><span class="linenos">264</span></a><span class="sd">        logfile : str, optional</span>
</span><span id="CHGNet.calc_md-265"><a href="#CHGNet.calc_md-265"><span class="linenos">265</span></a><span class="sd">            Name of the output log file (default is &#39;md_run.log&#39;).</span>
</span><span id="CHGNet.calc_md-266"><a href="#CHGNet.calc_md-266"><span class="linenos">266</span></a><span class="sd">        on_isolated_atoms : {&#39;ignore&#39;, &#39;warn&#39;, &#39;error&#39;}, optional</span>
</span><span id="CHGNet.calc_md-267"><a href="#CHGNet.calc_md-267"><span class="linenos">267</span></a><span class="sd">            Behavior for isolated atoms (default is &#39;warn&#39;).</span>
</span><span id="CHGNet.calc_md-268"><a href="#CHGNet.calc_md-268"><span class="linenos">268</span></a><span class="sd">        starting_temperature : int or None, optional</span>
</span><span id="CHGNet.calc_md-269"><a href="#CHGNet.calc_md-269"><span class="linenos">269</span></a><span class="sd">            Initial temperature of the simulation (default is the target temperature).</span>
</span><span id="CHGNet.calc_md-270"><a href="#CHGNet.calc_md-270"><span class="linenos">270</span></a><span class="sd">        ensemble : str, optional</span>
</span><span id="CHGNet.calc_md-271"><a href="#CHGNet.calc_md-271"><span class="linenos">271</span></a><span class="sd">            Ensemble type, e.g., &#39;nvt&#39; or &#39;npt&#39; (default is &#39;nvt&#39;).</span>
</span><span id="CHGNet.calc_md-272"><a href="#CHGNet.calc_md-272"><span class="linenos">272</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.calc_md-273"><a href="#CHGNet.calc_md-273"><span class="linenos">273</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">calc_md</span><span class="p">(</span>
</span><span id="CHGNet.calc_md-274"><a href="#CHGNet.calc_md-274"><span class="linenos">274</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-275"><a href="#CHGNet.calc_md-275"><span class="linenos">275</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-276"><a href="#CHGNet.calc_md-276"><span class="linenos">276</span></a>            <span class="n">n_ionic_steps</span><span class="o">=</span><span class="n">n_ionic_steps</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-277"><a href="#CHGNet.calc_md-277"><span class="linenos">277</span></a>            <span class="n">time_step</span><span class="o">=</span><span class="n">time_step</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-278"><a href="#CHGNet.calc_md-278"><span class="linenos">278</span></a>            <span class="n">n_print</span><span class="o">=</span><span class="n">n_print</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-279"><a href="#CHGNet.calc_md-279"><span class="linenos">279</span></a>            <span class="n">temperature_damping_timescale</span><span class="o">=</span><span class="n">temperature_damping_timescale</span><span class="p">,</span>
</span><span id="CHGNet.calc_md-280"><a href="#CHGNet.calc_md-280"><span class="linenos">280</span></a>            <span class="n">pressure_damping_timescale</span><span class="o">=</span><span class="n">pressure_damping_timescale</span><span class="p">,</span>            
</span><span id="CHGNet.calc_md-281"><a href="#CHGNet.calc_md-281"><span class="linenos">281</span></a>        <span class="p">)</span>
</span><span id="CHGNet.calc_md-282"><a href="#CHGNet.calc_md-282"><span class="linenos">282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;ensemble&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ensemble</span>
</span><span id="CHGNet.calc_md-283"><a href="#CHGNet.calc_md-283"><span class="linenos">283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
</span><span id="CHGNet.calc_md-284"><a href="#CHGNet.calc_md-284"><span class="linenos">284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logfile</span>
</span><span id="CHGNet.calc_md-285"><a href="#CHGNet.calc_md-285"><span class="linenos">285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;on_isolated_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_isolated_atoms</span>
</span><span id="CHGNet.calc_md-286"><a href="#CHGNet.calc_md-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="n">starting_temperature</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet.calc_md-287"><a href="#CHGNet.calc_md-287"><span class="linenos">287</span></a>            <span class="n">starting_temperature</span><span class="o">=</span><span class="n">temperature</span>
</span><span id="CHGNet.calc_md-288"><a href="#CHGNet.calc_md-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;starting_temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">starting_temperature</span>
</span></pre></div>


            <div class="docstring"><p>Set up and perform a molecular dynamics (MD) simulation. More CHGNet parameters can be specified by 
explicitly adding them to <code>job.input</code> dictionary, see
<a href="https://chgnet.lbl.gov/api#class-moleculardynamics">https://chgnet.lbl.gov/api#class-moleculardynamics</a>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>temperature</strong> (float, optional):
Target temperature of the simulation in Kelvin (default is 300 K).</li>
<li><strong>pressure</strong> (float or None, optional):
Target pressure for the simulation in bar (default is None).</li>
<li><strong>n_ionic_steps</strong> (int, optional):
Number of ionic steps to simulate (default is 100).</li>
<li><strong>time_step</strong> (float, optional):
Time step for the simulation in femtoseconds (default is 2.0 fs).</li>
<li><strong>n_print</strong> (int, optional):
Frequency of printing simulation logs (default is 10).</li>
<li><strong>temperature_damping_timescale</strong> (float, optional):
Timescale for temperature damping in femtoseconds (default is 100.0 fs).</li>
<li><strong>pressure_damping_timescale</strong> (float or None, optional):
Timescale for pressure damping in femtoseconds (default is None).</li>
<li><strong>trajectory</strong> (str, optional):
Name of the output trajectory file (default is 'md_run.traj').</li>
<li><strong>logfile</strong> (str, optional):
Name of the output log file (default is 'md_run.log').</li>
<li><strong>on_isolated_atoms</strong> ({'ignore', 'warn', 'error'}, optional):
Behavior for isolated atoms (default is 'warn').</li>
<li><strong>starting_temperature</strong> (int or None, optional):
Initial temperature of the simulation (default is the target temperature).</li>
<li><strong>ensemble</strong> (str, optional):
Ensemble type, e.g., 'nvt' or 'npt' (default is 'nvt').</li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.write_input" class="classattr">
                                        <input id="CHGNet.write_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_input</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CHGNet.write_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.write_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.write_input-340"><a href="#CHGNet.write_input-340"><span class="linenos">340</span></a>    <span class="k">def</span> <span class="nf">write_input</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet.write_input-341"><a href="#CHGNet.write_input-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.write_input-342"><a href="#CHGNet.write_input-342"><span class="linenos">342</span></a><span class="sd">        Write input files required for the CHGNet calculation.</span>
</span><span id="CHGNet.write_input-343"><a href="#CHGNet.write_input-343"><span class="linenos">343</span></a>
</span><span id="CHGNet.write_input-344"><a href="#CHGNet.write_input-344"><span class="linenos">344</span></a><span class="sd">        This function writes the structure file (`structure.cif`), stores the input </span>
</span><span id="CHGNet.write_input-345"><a href="#CHGNet.write_input-345"><span class="linenos">345</span></a><span class="sd">        dictionary to the HDF5 format, and delegates further writing depending on the </span>
</span><span id="CHGNet.write_input-346"><a href="#CHGNet.write_input-346"><span class="linenos">346</span></a><span class="sd">        calculation mode (MD or static/minimize).</span>
</span><span id="CHGNet.write_input-347"><a href="#CHGNet.write_input-347"><span class="linenos">347</span></a>
</span><span id="CHGNet.write_input-348"><a href="#CHGNet.write_input-348"><span class="linenos">348</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet.write_input-349"><a href="#CHGNet.write_input-349"><span class="linenos">349</span></a><span class="sd">        -------</span>
</span><span id="CHGNet.write_input-350"><a href="#CHGNet.write_input-350"><span class="linenos">350</span></a><span class="sd">        None</span>
</span><span id="CHGNet.write_input-351"><a href="#CHGNet.write_input-351"><span class="linenos">351</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.write_input-352"><a href="#CHGNet.write_input-352"><span class="linenos">352</span></a>        <span class="n">write</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;structure.cif&#39;</span><span class="p">),</span> <span class="n">pyiron_to_ase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">))</span>
</span><span id="CHGNet.write_input-353"><a href="#CHGNet.write_input-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
</span><span id="CHGNet.write_input-354"><a href="#CHGNet.write_input-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="CHGNet.write_input-355"><a href="#CHGNet.write_input-355"><span class="linenos">355</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_md</span><span class="p">()</span>
</span><span id="CHGNet.write_input-356"><a href="#CHGNet.write_input-356"><span class="linenos">356</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CHGNet.write_input-357"><a href="#CHGNet.write_input-357"><span class="linenos">357</span></a>            <span class="c1"># calc_mode = static is treated as minimize with only a single ioninc step</span>
</span><span id="CHGNet.write_input-358"><a href="#CHGNet.write_input-358"><span class="linenos">358</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_write_calc_minimize</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Write input files required for the CHGNet calculation.</p>

<p>This function writes the structure file (<code>structure.cif</code>), stores the input 
dictionary to the HDF5 format, and delegates further writing depending on the 
calculation mode (MD or static/minimize).</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.collect_output" class="classattr">
                                        <input id="CHGNet.collect_output-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_output</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="CHGNet.collect_output-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.collect_output"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.collect_output-430"><a href="#CHGNet.collect_output-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">collect_output</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-431"><a href="#CHGNet.collect_output-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.collect_output-432"><a href="#CHGNet.collect_output-432"><span class="linenos">432</span></a><span class="sd">        Collect and store the results of the calculation.</span>
</span><span id="CHGNet.collect_output-433"><a href="#CHGNet.collect_output-433"><span class="linenos">433</span></a>
</span><span id="CHGNet.collect_output-434"><a href="#CHGNet.collect_output-434"><span class="linenos">434</span></a><span class="sd">        This function parses the final structure, trajectory, and other output properties,</span>
</span><span id="CHGNet.collect_output-435"><a href="#CHGNet.collect_output-435"><span class="linenos">435</span></a><span class="sd">        and stores them in the HDF5 format. The structure is updated, and various properties </span>
</span><span id="CHGNet.collect_output-436"><a href="#CHGNet.collect_output-436"><span class="linenos">436</span></a><span class="sd">        such as energies, forces, and magnetization are saved to the output group.</span>
</span><span id="CHGNet.collect_output-437"><a href="#CHGNet.collect_output-437"><span class="linenos">437</span></a>
</span><span id="CHGNet.collect_output-438"><a href="#CHGNet.collect_output-438"><span class="linenos">438</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet.collect_output-439"><a href="#CHGNet.collect_output-439"><span class="linenos">439</span></a><span class="sd">        -------</span>
</span><span id="CHGNet.collect_output-440"><a href="#CHGNet.collect_output-440"><span class="linenos">440</span></a><span class="sd">        None</span>
</span><span id="CHGNet.collect_output-441"><a href="#CHGNet.collect_output-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.collect_output-442"><a href="#CHGNet.collect_output-442"><span class="linenos">442</span></a>                    
</span><span id="CHGNet.collect_output-443"><a href="#CHGNet.collect_output-443"><span class="linenos">443</span></a>        <span class="n">relaxed_ase_structure</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s1">&#39;final_structure.cif&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;cif&#39;</span><span class="p">)</span>
</span><span id="CHGNet.collect_output-444"><a href="#CHGNet.collect_output-444"><span class="linenos">444</span></a>        <span class="n">relaxed_pyiron_structure</span> <span class="o">=</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">relaxed_ase_structure</span><span class="p">)</span>
</span><span id="CHGNet.collect_output-445"><a href="#CHGNet.collect_output-445"><span class="linenos">445</span></a>
</span><span id="CHGNet.collect_output-446"><a href="#CHGNet.collect_output-446"><span class="linenos">446</span></a>        <span class="c1"># Store the relaxed structure in the HDF5 group</span>
</span><span id="CHGNet.collect_output-447"><a href="#CHGNet.collect_output-447"><span class="linenos">447</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-448"><a href="#CHGNet.collect_output-448"><span class="linenos">448</span></a>            <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>
</span><span id="CHGNet.collect_output-449"><a href="#CHGNet.collect_output-449"><span class="linenos">449</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">relaxed_pyiron_structure</span>  <span class="c1"># Update the job&#39;s structure</span>
</span><span id="CHGNet.collect_output-450"><a href="#CHGNet.collect_output-450"><span class="linenos">450</span></a>
</span><span id="CHGNet.collect_output-451"><a href="#CHGNet.collect_output-451"><span class="linenos">451</span></a>        <span class="c1"># Parse trajectory        </span>
</span><span id="CHGNet.collect_output-452"><a href="#CHGNet.collect_output-452"><span class="linenos">452</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>
</span><span id="CHGNet.collect_output-453"><a href="#CHGNet.collect_output-453"><span class="linenos">453</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;save_path&#39;</span><span class="p">]</span>
</span><span id="CHGNet.collect_output-454"><a href="#CHGNet.collect_output-454"><span class="linenos">454</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-455"><a href="#CHGNet.collect_output-455"><span class="linenos">455</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-456"><a href="#CHGNet.collect_output-456"><span class="linenos">456</span></a>                    <span class="n">traj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>                   
</span><span id="CHGNet.collect_output-457"><a href="#CHGNet.collect_output-457"><span class="linenos">457</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-458"><a href="#CHGNet.collect_output-458"><span class="linenos">458</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-459"><a href="#CHGNet.collect_output-459"><span class="linenos">459</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="s1">&#39;atom_positions&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-460"><a href="#CHGNet.collect_output-460"><span class="linenos">460</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]],[</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]]]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet.collect_output-461"><a href="#CHGNet.collect_output-461"><span class="linenos">461</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet.collect_output-462"><a href="#CHGNet.collect_output-462"><span class="linenos">462</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/dft&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-463"><a href="#CHGNet.collect_output-463"><span class="linenos">463</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;magnetization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;magmoms&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span><span id="CHGNet.collect_output-464"><a href="#CHGNet.collect_output-464"><span class="linenos">464</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-465"><a href="#CHGNet.collect_output-465"><span class="linenos">465</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet.collect_output-466"><a href="#CHGNet.collect_output-466"><span class="linenos">466</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>            
</span><span id="CHGNet.collect_output-467"><a href="#CHGNet.collect_output-467"><span class="linenos">467</span></a>            <span class="n">traj_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>
</span><span id="CHGNet.collect_output-468"><a href="#CHGNet.collect_output-468"><span class="linenos">468</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-469"><a href="#CHGNet.collect_output-469"><span class="linenos">469</span></a>                <span class="n">traj</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="n">traj_file</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="CHGNet.collect_output-470"><a href="#CHGNet.collect_output-470"><span class="linenos">470</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-471"><a href="#CHGNet.collect_output-471"><span class="linenos">471</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;cells&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-472"><a href="#CHGNet.collect_output-472"><span class="linenos">472</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;positions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-473"><a href="#CHGNet.collect_output-473"><span class="linenos">473</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;stresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_stress</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-474"><a href="#CHGNet.collect_output-474"><span class="linenos">474</span></a>                    <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">get_forces</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-475"><a href="#CHGNet.collect_output-475"><span class="linenos">475</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-476"><a href="#CHGNet.collect_output-476"><span class="linenos">476</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot parse output from </span><span class="si">{</span><span class="n">traj_file</span><span class="si">}</span><span class="s1"> file.&#39;</span><span class="p">)</span>
</span><span id="CHGNet.collect_output-477"><a href="#CHGNet.collect_output-477"><span class="linenos">477</span></a>
</span><span id="CHGNet.collect_output-478"><a href="#CHGNet.collect_output-478"><span class="linenos">478</span></a>        <span class="c1"># Parse other properties</span>
</span><span id="CHGNet.collect_output-479"><a href="#CHGNet.collect_output-479"><span class="linenos">479</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;minimize&#39;</span><span class="p">]:</span>            
</span><span id="CHGNet.collect_output-480"><a href="#CHGNet.collect_output-480"><span class="linenos">480</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_static</span><span class="p">()</span>
</span><span id="CHGNet.collect_output-481"><a href="#CHGNet.collect_output-481"><span class="linenos">481</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-482"><a href="#CHGNet.collect_output-482"><span class="linenos">482</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-483"><a href="#CHGNet.collect_output-483"><span class="linenos">483</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-484"><a href="#CHGNet.collect_output-484"><span class="linenos">484</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fmax&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-485"><a href="#CHGNet.collect_output-485"><span class="linenos">485</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Step&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-486"><a href="#CHGNet.collect_output-486"><span class="linenos">486</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generic_input</span><span class="p">[</span><span class="s1">&#39;calc_mode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md&#39;</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-487"><a href="#CHGNet.collect_output-487"><span class="linenos">487</span></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_calc_md</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;logfile&#39;</span><span class="p">])</span>
</span><span id="CHGNet.collect_output-488"><a href="#CHGNet.collect_output-488"><span class="linenos">488</span></a>            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.collect_output-489"><a href="#CHGNet.collect_output-489"><span class="linenos">489</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_pot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Epot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-490"><a href="#CHGNet.collect_output-490"><span class="linenos">490</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Etot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>                
</span><span id="CHGNet.collect_output-491"><a href="#CHGNet.collect_output-491"><span class="linenos">491</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;energy_kin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ekin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-492"><a href="#CHGNet.collect_output-492"><span class="linenos">492</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-493"><a href="#CHGNet.collect_output-493"><span class="linenos">493</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-494"><a href="#CHGNet.collect_output-494"><span class="linenos">494</span></a>                <span class="n">h5out</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</span><span id="CHGNet.collect_output-495"><a href="#CHGNet.collect_output-495"><span class="linenos">495</span></a>
</span><span id="CHGNet.collect_output-496"><a href="#CHGNet.collect_output-496"><span class="linenos">496</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">finished</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Collect and store the results of the calculation.</p>

<p>This function parses the final structure, trajectory, and other output properties,
and stores them in the HDF5 format. The structure is updated, and various properties 
such as energies, forces, and magnetization are saved to the output group.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="CHGNet.get_structure" class="classattr">
                                        <input id="CHGNet.get_structure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_structure</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></span><span class="return-annotation">) -> <span class="n">ase</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">Atoms</span>:</span></span>

                <label class="view-source-button" for="CHGNet.get_structure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CHGNet.get_structure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CHGNet.get_structure-499"><a href="#CHGNet.get_structure-499"><span class="linenos">499</span></a>    <span class="k">def</span> <span class="nf">get_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atoms</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-500"><a href="#CHGNet.get_structure-500"><span class="linenos">500</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CHGNet.get_structure-501"><a href="#CHGNet.get_structure-501"><span class="linenos">501</span></a><span class="sd">        Retrieve the structure at a given frame from the calculation output.</span>
</span><span id="CHGNet.get_structure-502"><a href="#CHGNet.get_structure-502"><span class="linenos">502</span></a>
</span><span id="CHGNet.get_structure-503"><a href="#CHGNet.get_structure-503"><span class="linenos">503</span></a><span class="sd">        This function returns the atomic structure (positions, cell, species) at the </span>
</span><span id="CHGNet.get_structure-504"><a href="#CHGNet.get_structure-504"><span class="linenos">504</span></a><span class="sd">        specified frame index. The frame index is adjusted to ensure it is valid.</span>
</span><span id="CHGNet.get_structure-505"><a href="#CHGNet.get_structure-505"><span class="linenos">505</span></a>
</span><span id="CHGNet.get_structure-506"><a href="#CHGNet.get_structure-506"><span class="linenos">506</span></a><span class="sd">        Parameters</span>
</span><span id="CHGNet.get_structure-507"><a href="#CHGNet.get_structure-507"><span class="linenos">507</span></a><span class="sd">        ----------</span>
</span><span id="CHGNet.get_structure-508"><a href="#CHGNet.get_structure-508"><span class="linenos">508</span></a><span class="sd">        frame : int, optional</span>
</span><span id="CHGNet.get_structure-509"><a href="#CHGNet.get_structure-509"><span class="linenos">509</span></a><span class="sd">            The frame index to retrieve. If negative, it is counted from the last frame, </span>
</span><span id="CHGNet.get_structure-510"><a href="#CHGNet.get_structure-510"><span class="linenos">510</span></a><span class="sd">            by default -1.</span>
</span><span id="CHGNet.get_structure-511"><a href="#CHGNet.get_structure-511"><span class="linenos">511</span></a>
</span><span id="CHGNet.get_structure-512"><a href="#CHGNet.get_structure-512"><span class="linenos">512</span></a><span class="sd">        Returns</span>
</span><span id="CHGNet.get_structure-513"><a href="#CHGNet.get_structure-513"><span class="linenos">513</span></a><span class="sd">        -------</span>
</span><span id="CHGNet.get_structure-514"><a href="#CHGNet.get_structure-514"><span class="linenos">514</span></a><span class="sd">        Atoms</span>
</span><span id="CHGNet.get_structure-515"><a href="#CHGNet.get_structure-515"><span class="linenos">515</span></a><span class="sd">            The ASE Atoms object representing the structure at the given frame.</span>
</span><span id="CHGNet.get_structure-516"><a href="#CHGNet.get_structure-516"><span class="linenos">516</span></a>
</span><span id="CHGNet.get_structure-517"><a href="#CHGNet.get_structure-517"><span class="linenos">517</span></a><span class="sd">        Raises</span>
</span><span id="CHGNet.get_structure-518"><a href="#CHGNet.get_structure-518"><span class="linenos">518</span></a><span class="sd">        ------</span>
</span><span id="CHGNet.get_structure-519"><a href="#CHGNet.get_structure-519"><span class="linenos">519</span></a><span class="sd">        ValueError</span>
</span><span id="CHGNet.get_structure-520"><a href="#CHGNet.get_structure-520"><span class="linenos">520</span></a><span class="sd">            If no structures are found in the job output.</span>
</span><span id="CHGNet.get_structure-521"><a href="#CHGNet.get_structure-521"><span class="linenos">521</span></a><span class="sd">        IndexError</span>
</span><span id="CHGNet.get_structure-522"><a href="#CHGNet.get_structure-522"><span class="linenos">522</span></a><span class="sd">            If the frame index is out of range.</span>
</span><span id="CHGNet.get_structure-523"><a href="#CHGNet.get_structure-523"><span class="linenos">523</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CHGNet.get_structure-524"><a href="#CHGNet.get_structure-524"><span class="linenos">524</span></a>        <span class="n">num_structures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_structures</span>
</span><span id="CHGNet.get_structure-525"><a href="#CHGNet.get_structure-525"><span class="linenos">525</span></a>        <span class="k">if</span> <span class="n">num_structures</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-526"><a href="#CHGNet.get_structure-526"><span class="linenos">526</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No structures found in the job output.&quot;</span><span class="p">)</span>
</span><span id="CHGNet.get_structure-527"><a href="#CHGNet.get_structure-527"><span class="linenos">527</span></a>
</span><span id="CHGNet.get_structure-528"><a href="#CHGNet.get_structure-528"><span class="linenos">528</span></a>        <span class="c1"># Ensure frame is valid</span>
</span><span id="CHGNet.get_structure-529"><a href="#CHGNet.get_structure-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-530"><a href="#CHGNet.get_structure-530"><span class="linenos">530</span></a>            <span class="n">frame</span> <span class="o">+=</span> <span class="n">num_structures</span>
</span><span id="CHGNet.get_structure-531"><a href="#CHGNet.get_structure-531"><span class="linenos">531</span></a>        <span class="k">if</span> <span class="n">frame</span> <span class="o">&gt;=</span> <span class="n">num_structures</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-532"><a href="#CHGNet.get_structure-532"><span class="linenos">532</span></a>            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
</span><span id="CHGNet.get_structure-533"><a href="#CHGNet.get_structure-533"><span class="linenos">533</span></a>                <span class="sa">f</span><span class="s2">&quot;Frame </span><span class="si">{</span><span class="n">frame</span><span class="si">}</span><span class="s2"> is out of range for </span><span class="si">{</span><span class="n">num_structures</span><span class="si">}</span><span class="s2"> structures.&quot;</span><span class="p">)</span>
</span><span id="CHGNet.get_structure-534"><a href="#CHGNet.get_structure-534"><span class="linenos">534</span></a>
</span><span id="CHGNet.get_structure-535"><a href="#CHGNet.get_structure-535"><span class="linenos">535</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/generic&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-536"><a href="#CHGNet.get_structure-536"><span class="linenos">536</span></a>            <span class="n">positions</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;positions&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>
</span><span id="CHGNet.get_structure-537"><a href="#CHGNet.get_structure-537"><span class="linenos">537</span></a>            <span class="n">cell</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;cells&quot;</span><span class="p">][</span><span class="n">frame</span><span class="p">]</span>            
</span><span id="CHGNet.get_structure-538"><a href="#CHGNet.get_structure-538"><span class="linenos">538</span></a>        <span class="c1"># Read positions and cell</span>
</span><span id="CHGNet.get_structure-539"><a href="#CHGNet.get_structure-539"><span class="linenos">539</span></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_hdf5</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output/structure&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5out</span><span class="p">:</span>
</span><span id="CHGNet.get_structure-540"><a href="#CHGNet.get_structure-540"><span class="linenos">540</span></a>            <span class="n">species</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span>
</span><span id="CHGNet.get_structure-541"><a href="#CHGNet.get_structure-541"><span class="linenos">541</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">h5out</span><span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">]</span>
</span><span id="CHGNet.get_structure-542"><a href="#CHGNet.get_structure-542"><span class="linenos">542</span></a>
</span><span id="CHGNet.get_structure-543"><a href="#CHGNet.get_structure-543"><span class="linenos">543</span></a>        <span class="c1"># Generate symbols list</span>
</span><span id="CHGNet.get_structure-544"><a href="#CHGNet.get_structure-544"><span class="linenos">544</span></a>        <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">species</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
</span><span id="CHGNet.get_structure-545"><a href="#CHGNet.get_structure-545"><span class="linenos">545</span></a>        <span class="k">return</span> <span class="n">ase_to_pyiron</span><span class="p">(</span><span class="n">Atoms</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Retrieve the structure at a given frame from the calculation output.</p>

<p>This function returns the atomic structure (positions, cell, species) at the 
specified frame index. The frame index is adjusted to ensure it is valid.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>frame</strong> (int, optional):
The frame index to retrieve. If negative, it is counted from the last frame, 
by default -1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Atoms</strong>: The ASE Atoms object representing the structure at the given frame.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>ValueError</strong>: If no structures are found in the job output.</li>
<li><strong>IndexError</strong>: If the frame index is out of range.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pyiron_atomistics.atomistics.job.atomistic.AtomisticGenericJob</dt>
                                <dd id="CHGNet.output" class="variable">output</dd>
                <dd id="CHGNet.map_functions" class="variable">map_functions</dd>
                <dd id="CHGNet.set_input_to_read_only" class="function">set_input_to_read_only</dd>
                <dd id="CHGNet.create_pipeline" class="function">create_pipeline</dd>
                <dd id="CHGNet.from_dict" class="function">from_dict</dd>
                <dd id="CHGNet.to_dict" class="function">to_dict</dd>
                <dd id="CHGNet.store_structure" class="function">store_structure</dd>
                <dd id="CHGNet.animate_structure" class="function">animate_structure</dd>
                <dd id="CHGNet.view_structure" class="function">view_structure</dd>
                <dd id="CHGNet.validate_ready_to_run" class="function">validate_ready_to_run</dd>
                <dd id="CHGNet.db_entry" class="function">db_entry</dd>
                <dd id="CHGNet.restart" class="function">restart</dd>
                <dd id="CHGNet.get_workdir_file" class="function">get_workdir_file</dd>
                <dd id="CHGNet.continue_with_restart_files" class="function">continue_with_restart_files</dd>
                <dd id="CHGNet.continue_with_final_structure" class="function">continue_with_final_structure</dd>
                <dd id="CHGNet.trajectory" class="function">trajectory</dd>
                <dd id="CHGNet.write_traj" class="function">write_traj</dd>
                <dd id="CHGNet.get_neighbors_snapshots" class="function">get_neighbors_snapshots</dd>
                <dd id="CHGNet.get_neighbors" class="function">get_neighbors</dd>
                <dd id="CHGNet.get_final_structure" class="function">get_final_structure</dd>
                <dd id="CHGNet.map" class="function">map</dd>
                <dd id="CHGNet.gui" class="function">gui</dd>

            </div>
            <div><dt>pyiron_base.jobs.job.generic.GenericJob</dt>
                                <dd id="CHGNet.interactive_cache" class="variable">interactive_cache</dd>
                <dd id="CHGNet.error" class="variable">error</dd>
                <dd id="CHGNet.version" class="variable">version</dd>
                <dd id="CHGNet.executable" class="variable">executable</dd>
                <dd id="CHGNet.server" class="variable">server</dd>
                <dd id="CHGNet.queue_id" class="variable">queue_id</dd>
                <dd id="CHGNet.logger" class="variable">logger</dd>
                <dd id="CHGNet.restart_file_list" class="variable">restart_file_list</dd>
                <dd id="CHGNet.restart_file_dict" class="variable">restart_file_dict</dd>
                <dd id="CHGNet.exclude_nodes_hdf" class="variable">exclude_nodes_hdf</dd>
                <dd id="CHGNet.exclude_groups_hdf" class="variable">exclude_groups_hdf</dd>
                <dd id="CHGNet.job_type" class="variable">job_type</dd>
                <dd id="CHGNet.working_directory" class="variable">working_directory</dd>
                <dd id="CHGNet.executor_type" class="variable">executor_type</dd>
                <dd id="CHGNet.calculate_kwargs" class="variable">calculate_kwargs</dd>
                <dd id="CHGNet.clear_job" class="function">clear_job</dd>
                <dd id="CHGNet.copy" class="function">copy</dd>
                <dd id="CHGNet.collect_logfiles" class="function">collect_logfiles</dd>
                <dd id="CHGNet.get_calculate_function" class="function">get_calculate_function</dd>
                <dd id="CHGNet.get_input_parameter_dict" class="function">get_input_parameter_dict</dd>
                <dd id="CHGNet.get_output_parameter_dict" class="function">get_output_parameter_dict</dd>
                <dd id="CHGNet.save_output" class="function">save_output</dd>
                <dd id="CHGNet.suspend" class="function">suspend</dd>
                <dd id="CHGNet.refresh_job_status" class="function">refresh_job_status</dd>
                <dd id="CHGNet.copy_to" class="function">copy_to</dd>
                <dd id="CHGNet.copy_file_to_working_directory" class="function">copy_file_to_working_directory</dd>
                <dd id="CHGNet.copy_template" class="function">copy_template</dd>
                <dd id="CHGNet.remove" class="function">remove</dd>
                <dd id="CHGNet.remove_child" class="function">remove_child</dd>
                <dd id="CHGNet.remove_and_reset_id" class="function">remove_and_reset_id</dd>
                <dd id="CHGNet.kill" class="function">kill</dd>
                <dd id="CHGNet.check_setup" class="function">check_setup</dd>
                <dd id="CHGNet.reset_job_id" class="function">reset_job_id</dd>
                <dd id="CHGNet.run" class="function">run</dd>
                <dd id="CHGNet.run_if_modal" class="function">run_if_modal</dd>
                <dd id="CHGNet.run_static" class="function">run_static</dd>
                <dd id="CHGNet.run_if_scheduler" class="function">run_if_scheduler</dd>
                <dd id="CHGNet.transfer_from_remote" class="function">transfer_from_remote</dd>
                <dd id="CHGNet.run_if_interactive" class="function">run_if_interactive</dd>
                <dd id="CHGNet.run_if_interactive_non_modal" class="function">run_if_interactive_non_modal</dd>
                <dd id="CHGNet.interactive_close" class="function">interactive_close</dd>
                <dd id="CHGNet.interactive_fetch" class="function">interactive_fetch</dd>
                <dd id="CHGNet.interactive_flush" class="function">interactive_flush</dd>
                <dd id="CHGNet.send_to_database" class="function">send_to_database</dd>
                <dd id="CHGNet.create_job" class="function">create_job</dd>
                <dd id="CHGNet.update_master" class="function">update_master</dd>
                <dd id="CHGNet.job_file_name" class="function">job_file_name</dd>
                <dd id="CHGNet.to_hdf" class="function">to_hdf</dd>
                <dd id="CHGNet.from_hdf_args" class="function">from_hdf_args</dd>
                <dd id="CHGNet.from_hdf" class="function">from_hdf</dd>
                <dd id="CHGNet.save" class="function">save</dd>
                <dd id="CHGNet.convergence_check" class="function">convergence_check</dd>
                <dd id="CHGNet.signal_intercept" class="function">signal_intercept</dd>
                <dd id="CHGNet.drop_status_to_aborted" class="function">drop_status_to_aborted</dd>
                <dd id="CHGNet.run_if_refresh" class="function">run_if_refresh</dd>
                <dd id="CHGNet.run_time_to_db" class="function">run_time_to_db</dd>

            </div>
            <div><dt>pyiron_base.jobs.job.core.JobCore</dt>
                                <dd id="CHGNet.content" class="variable">content</dd>
                <dd id="CHGNet.files" class="variable">files</dd>
                <dd id="CHGNet.job_name" class="variable">job_name</dd>
                <dd id="CHGNet.name" class="variable">name</dd>
                <dd id="CHGNet.status" class="variable">status</dd>
                <dd id="CHGNet.job_id" class="variable">job_id</dd>
                <dd id="CHGNet.id" class="variable">id</dd>
                <dd id="CHGNet.database_entry" class="variable">database_entry</dd>
                <dd id="CHGNet.parent_id" class="variable">parent_id</dd>
                <dd id="CHGNet.master_id" class="variable">master_id</dd>
                <dd id="CHGNet.child_ids" class="variable">child_ids</dd>
                <dd id="CHGNet.project_hdf5" class="variable">project_hdf5</dd>
                <dd id="CHGNet.files_to_compress" class="variable">files_to_compress</dd>
                <dd id="CHGNet.files_to_remove" class="variable">files_to_remove</dd>
                <dd id="CHGNet.relocate_hdf5" class="function">relocate_hdf5</dd>
                <dd id="CHGNet.project" class="variable">project</dd>
                <dd id="CHGNet.job_info_str" class="variable">job_info_str</dd>
                <dd id="CHGNet.path" class="variable">path</dd>
                <dd id="CHGNet.check_if_job_exists" class="function">check_if_job_exists</dd>
                <dd id="CHGNet.show_hdf" class="function">show_hdf</dd>
                <dd id="CHGNet.get_from_table" class="function">get_from_table</dd>
                <dd id="CHGNet.to_object" class="function">to_object</dd>
                <dd id="CHGNet.get" class="function">get</dd>
                <dd id="CHGNet.load" class="function">load</dd>
                <dd id="CHGNet.inspect" class="function">inspect</dd>
                <dd id="CHGNet.is_master_id" class="function">is_master_id</dd>
                <dd id="CHGNet.get_job_id" class="function">get_job_id</dd>
                <dd id="CHGNet.list_files" class="function">list_files</dd>
                <dd id="CHGNet.list_childs" class="function">list_childs</dd>
                <dd id="CHGNet.move_to" class="function">move_to</dd>
                <dd id="CHGNet.rename" class="function">rename</dd>
                <dd id="CHGNet.compress" class="function">compress</dd>
                <dd id="CHGNet.decompress" class="function">decompress</dd>
                <dd id="CHGNet.is_compressed" class="function">is_compressed</dd>
                <dd id="CHGNet.self_archive" class="function">self_archive</dd>
                <dd id="CHGNet.self_unarchive" class="function">self_unarchive</dd>
                <dd id="CHGNet.is_self_archived" class="function">is_self_archived</dd>

            </div>
            <div><dt>pyiron_base.interfaces.has_groups.HasGroups</dt>
                                <dd id="CHGNet.list_groups" class="function">list_groups</dd>
                <dd id="CHGNet.list_nodes" class="function">list_nodes</dd>
                <dd id="CHGNet.list_all" class="function">list_all</dd>

            </div>
            <div><dt>pyiron_atomistics.atomistics.structure.has_structure.HasStructure</dt>
                                <dd id="CHGNet.number_of_structures" class="variable">number_of_structures</dd>
                <dd id="CHGNet.iter_structures" class="function">iter_structures</dd>
                <dd id="CHGNet.transform_structures" class="function">transform_structures</dd>
                <dd id="CHGNet.collect_structures" class="function">collect_structures</dd>
                <dd id="CHGNet.animate_structures" class="function">animate_structures</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="CalcParams">
                            <input id="CalcParams-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CalcParams</span><wbr>(<span class="base">pyiron_base.storage.parameters.GenericParameters</span>):

                <label class="view-source-button" for="CalcParams-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CalcParams"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CalcParams-549"><a href="#CalcParams-549"><span class="linenos">549</span></a><span class="k">class</span> <span class="nc">CalcParams</span><span class="p">(</span><span class="n">GenericParameters</span><span class="p">):</span>
</span><span id="CalcParams-550"><a href="#CalcParams-550"><span class="linenos">550</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CalcParams-551"><a href="#CalcParams-551"><span class="linenos">551</span></a><span class="sd">    Class to manage the calculation parameters for CHGNet calculations.</span>
</span><span id="CalcParams-552"><a href="#CalcParams-552"><span class="linenos">552</span></a>
</span><span id="CalcParams-553"><a href="#CalcParams-553"><span class="linenos">553</span></a><span class="sd">    This class extends from `GenericParameters` and is used to define and manage </span>
</span><span id="CalcParams-554"><a href="#CalcParams-554"><span class="linenos">554</span></a><span class="sd">    parameters specific to CHGNet calculations. It allows for initialization of </span>
</span><span id="CalcParams-555"><a href="#CalcParams-555"><span class="linenos">555</span></a><span class="sd">    parameters and stores them in a table, with a default table name of &quot;chgnet&quot;. </span>
</span><span id="CalcParams-556"><a href="#CalcParams-556"><span class="linenos">556</span></a><span class="sd">    The class can be used to load and store various CHGNet calculation settings and </span>
</span><span id="CalcParams-557"><a href="#CalcParams-557"><span class="linenos">557</span></a><span class="sd">    other related configurations.</span>
</span><span id="CalcParams-558"><a href="#CalcParams-558"><span class="linenos">558</span></a>
</span><span id="CalcParams-559"><a href="#CalcParams-559"><span class="linenos">559</span></a><span class="sd">    Parameters</span>
</span><span id="CalcParams-560"><a href="#CalcParams-560"><span class="linenos">560</span></a><span class="sd">    ----------</span>
</span><span id="CalcParams-561"><a href="#CalcParams-561"><span class="linenos">561</span></a><span class="sd">    table_name : str, optional</span>
</span><span id="CalcParams-562"><a href="#CalcParams-562"><span class="linenos">562</span></a><span class="sd">        The name of the table where the parameters are stored. By default, it is set </span>
</span><span id="CalcParams-563"><a href="#CalcParams-563"><span class="linenos">563</span></a><span class="sd">        to &quot;chgnet&quot;, but it can be customized if necessary.</span>
</span><span id="CalcParams-564"><a href="#CalcParams-564"><span class="linenos">564</span></a><span class="sd">    </span>
</span><span id="CalcParams-565"><a href="#CalcParams-565"><span class="linenos">565</span></a><span class="sd">    Methods</span>
</span><span id="CalcParams-566"><a href="#CalcParams-566"><span class="linenos">566</span></a><span class="sd">    -------</span>
</span><span id="CalcParams-567"><a href="#CalcParams-567"><span class="linenos">567</span></a><span class="sd">    __init__(self, table_name=&quot;chgnet&quot;)</span>
</span><span id="CalcParams-568"><a href="#CalcParams-568"><span class="linenos">568</span></a><span class="sd">        Initializes the parameters for the calculation.</span>
</span><span id="CalcParams-569"><a href="#CalcParams-569"><span class="linenos">569</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CalcParams-570"><a href="#CalcParams-570"><span class="linenos">570</span></a>    
</span><span id="CalcParams-571"><a href="#CalcParams-571"><span class="linenos">571</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;chgnet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CalcParams-572"><a href="#CalcParams-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CalcParams-573"><a href="#CalcParams-573"><span class="linenos">573</span></a><span class="sd">        Initialize the CalcParams object with the given table name.</span>
</span><span id="CalcParams-574"><a href="#CalcParams-574"><span class="linenos">574</span></a>
</span><span id="CalcParams-575"><a href="#CalcParams-575"><span class="linenos">575</span></a><span class="sd">        Parameters</span>
</span><span id="CalcParams-576"><a href="#CalcParams-576"><span class="linenos">576</span></a><span class="sd">        ----------</span>
</span><span id="CalcParams-577"><a href="#CalcParams-577"><span class="linenos">577</span></a><span class="sd">        table_name : str, optional</span>
</span><span id="CalcParams-578"><a href="#CalcParams-578"><span class="linenos">578</span></a><span class="sd">            The name of the table where the parameters are stored. By default, </span>
</span><span id="CalcParams-579"><a href="#CalcParams-579"><span class="linenos">579</span></a><span class="sd">            it is set to &quot;chgnet&quot;.</span>
</span><span id="CalcParams-580"><a href="#CalcParams-580"><span class="linenos">580</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CalcParams-581"><a href="#CalcParams-581"><span class="linenos">581</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CalcParams</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CalcParams-582"><a href="#CalcParams-582"><span class="linenos">582</span></a>            <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
</span><span id="CalcParams-583"><a href="#CalcParams-583"><span class="linenos">583</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class to manage the calculation parameters for CHGNet calculations.</p>

<p>This class extends from <code>GenericParameters</code> and is used to define and manage 
parameters specific to CHGNet calculations. It allows for initialization of 
parameters and stores them in a table, with a default table name of "chgnet". 
The class can be used to load and store various CHGNet calculation settings and 
other related configurations.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>table_name</strong> (str, optional):
The name of the table where the parameters are stored. By default, it is set 
to "chgnet", but it can be customized if necessary.</li>
</ul>

<h6 id="methods">Methods</h6>

<p>__init__(self, table_name="chgnet")
    Initializes the parameters for the calculation.</p>
</div>


                            <div id="CalcParams.__init__" class="classattr">
                                        <input id="CalcParams.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">CalcParams</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;chgnet&#39;</span></span>)</span>

                <label class="view-source-button" for="CalcParams.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CalcParams.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CalcParams.__init__-571"><a href="#CalcParams.__init__-571"><span class="linenos">571</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;chgnet&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CalcParams.__init__-572"><a href="#CalcParams.__init__-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="CalcParams.__init__-573"><a href="#CalcParams.__init__-573"><span class="linenos">573</span></a><span class="sd">        Initialize the CalcParams object with the given table name.</span>
</span><span id="CalcParams.__init__-574"><a href="#CalcParams.__init__-574"><span class="linenos">574</span></a>
</span><span id="CalcParams.__init__-575"><a href="#CalcParams.__init__-575"><span class="linenos">575</span></a><span class="sd">        Parameters</span>
</span><span id="CalcParams.__init__-576"><a href="#CalcParams.__init__-576"><span class="linenos">576</span></a><span class="sd">        ----------</span>
</span><span id="CalcParams.__init__-577"><a href="#CalcParams.__init__-577"><span class="linenos">577</span></a><span class="sd">        table_name : str, optional</span>
</span><span id="CalcParams.__init__-578"><a href="#CalcParams.__init__-578"><span class="linenos">578</span></a><span class="sd">            The name of the table where the parameters are stored. By default, </span>
</span><span id="CalcParams.__init__-579"><a href="#CalcParams.__init__-579"><span class="linenos">579</span></a><span class="sd">            it is set to &quot;chgnet&quot;.</span>
</span><span id="CalcParams.__init__-580"><a href="#CalcParams.__init__-580"><span class="linenos">580</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CalcParams.__init__-581"><a href="#CalcParams.__init__-581"><span class="linenos">581</span></a>        <span class="nb">super</span><span class="p">(</span><span class="n">CalcParams</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CalcParams.__init__-582"><a href="#CalcParams.__init__-582"><span class="linenos">582</span></a>            <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
</span><span id="CalcParams.__init__-583"><a href="#CalcParams.__init__-583"><span class="linenos">583</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize the CalcParams object with the given table name.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>table_name</strong> (str, optional):
The name of the table where the parameters are stored. By default, 
it is set to "chgnet".</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>pyiron_base.storage.parameters.GenericParameters</dt>
                                <dd id="CalcParams.end_value_char" class="variable">end_value_char</dd>
                <dd id="CalcParams.file_name" class="variable">file_name</dd>
                <dd id="CalcParams.table_name" class="variable">table_name</dd>
                <dd id="CalcParams.val_only" class="variable">val_only</dd>
                <dd id="CalcParams.comment_char" class="variable">comment_char</dd>
                <dd id="CalcParams.separator_char" class="variable">separator_char</dd>
                <dd id="CalcParams.multi_word_separator" class="variable">multi_word_separator</dd>
                <dd id="CalcParams.read_only" class="variable">read_only</dd>
                <dd id="CalcParams.replace_char_dict" class="variable">replace_char_dict</dd>
                <dd id="CalcParams.load_string" class="function">load_string</dd>
                <dd id="CalcParams.load_default" class="function">load_default</dd>
                <dd id="CalcParams.keys" class="function">keys</dd>
                <dd id="CalcParams.read_input" class="function">read_input</dd>
                <dd id="CalcParams.get_pandas" class="function">get_pandas</dd>
                <dd id="CalcParams.get" class="function">get</dd>
                <dd id="CalcParams.get_attribute" class="function">get_attribute</dd>
                <dd id="CalcParams.modify" class="function">modify</dd>
                <dd id="CalcParams.set" class="function">set</dd>
                <dd id="CalcParams.set_value" class="function">set_value</dd>
                <dd id="CalcParams.remove_keys" class="function">remove_keys</dd>
                <dd id="CalcParams.define_blocks" class="function">define_blocks</dd>
                <dd id="CalcParams.to_dict" class="function">to_dict</dd>
                <dd id="CalcParams.from_dict" class="function">from_dict</dd>
                <dd id="CalcParams.to_hdf" class="function">to_hdf</dd>
                <dd id="CalcParams.from_hdf" class="function">from_hdf</dd>
                <dd id="CalcParams.get_string_lst" class="function">get_string_lst</dd>
                <dd id="CalcParams.write_file" class="function">write_file</dd>
                <dd id="CalcParams.set_dict" class="function">set_dict</dd>
                <dd id="CalcParams.clear_all" class="function">clear_all</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>